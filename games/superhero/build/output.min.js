var __extends=this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i},Superhero;!function(t){var e=function(){function t(){}return t.intepolate=function(t,e,i,s,o){return(o-t)*(s-e)/(i-t)+e},t.semiRandomList=function(t){var e=this.orderdList(t);return this.shuffleArray(e)},t.randomList=function(t,e,i,s,o){void 0===o&&(o=!1);var a=[];return a},t.shuffleArray=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(Math.random()*(e+1)),s=t[e];t[e]=t[i],t[i]=s}return t},t.orderdList=function(t){return Array.apply(null,{length:t}).map(Number.call,Number)},t.groupConcat=function(t,e){return t.children=t.children.concat(e.children),t},t.interval=function(t,e,i){var s=function(e,i){return function(){if("undefined"==typeof i||i-->0){setTimeout(s,e);try{t.call(null)}catch(o){throw i=0,o.toString()}}}}(e,i);setTimeout(s,e)},t}();t.Utils=e;var i=function(t){function e(e,i,s,o,a,n){void 0===i&&(i=50),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===n&&(n=6),t.call(this,e,s/2,o/2),this.atRest=!1,this.game=e,this.radius=i,this.rotation=a,this.moveTo(this.x,this.y),this.sides=3>n?3:n,this.game.add.existing(this)}return __extends(e,t),e.prototype.drawCircleAtSelf=function(){this.drawCircle(this.x,this.y,2*this.radius)},e.prototype.drawWithFill=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=1),this.clear(),this.beginFill(e,i),this.draw(t),this.endFill()},e.prototype.lineToRadians=function(t,e){this.lineTo(Math.cos(t)*e+this.x,Math.sin(t)*e+this.y)},e.prototype.draw=function(t){this.moveTo(this.x,this.y);var e=this.radius;e/=Math.cos(1/this.sides*Math.PI);for(var i=Math.floor(t*this.sides),s=0;i>=s;s++)this.lineToRadians(s/this.sides*2*Math.PI+this.rotation,e);t*this.sides!=i&&this.lineToRadians(2*t*Math.PI+this.rotation,e)},e}(Phaser.Graphics);t.PieMask=i}(Superhero||(Superhero={}));var TextInfo;!function(t){!function(t){t[t.PRAISE=1]="PRAISE",t[t.CRITICIZE=2]="CRITICIZE"}(t.TextType||(t.TextType={}));var e=(t.TextType,function(){function t(t){this.xDirection=-1,this.game=t,this.goodJobText=[{text:"Nice!",level:1},{text:"Well Done!",level:3},{text:"Keep it up!",level:4},{text:"Good Job!",level:6},{text:"Perfect!",level:9},{text:"Awesome!",level:12},{text:"Sublime!",level:15},{text:"Oh yeah!",level:18},{text:"Superb!",level:21}],this.badJobText=[{text:"Darn",level:1},{text:"Oh god!",level:3},{text:"Shall I keep looking?",level:6},{text:"Please don't",level:9},{text:"You better start practicing!",level:12},{text:"Dude!",level:15},{text:"Blimey!",level:18},{text:"Are you even paying attention?",level:21}],this.comboText=[{text:"Bullseye",level:1},{text:"Marksman",level:2},{text:"Smoking",level:3},{text:"Multi blow",level:4},{text:"Super hit",level:5},{text:"Rampage!",level:6},{text:"Destruction Spree!",level:7},{text:"Unnstopable",level:8},{text:"Insane",level:9},{text:"Armageddon!",level:10},{text:"Godlike",level:11}]}return t.prototype.showGoodJobText=function(){{var t={font:"30px saranaigamebold",fill:"#FDCD08",align:"center"},e=this.goodJobText[this.game.rnd.integerInRange(0,this.goodJobText.length-1)].text,i=this.game.add.text(this.game.world.centerX,this.game.world.centerY,e,t),s=i.x-200*this.xDirection*this.game.rnd.integerInRange(1,2),o=i.y-100;this.game.add.tween(i).to({x:s,y:o},1e3,Phaser.Easing.Default,!0,0,0,!1).onComplete.add(function(){i.destroy()},this)}this.xDirection*=-1},t.prototype.showBadJobText=function(){{var t={font:"30px saranaigamebold",fill:"#FF0000",align:"center"},e=this.badJobText[this.game.rnd.integerInRange(0,this.badJobText.length-1)].text,i=this.game.add.text(this.game.world.centerX,this.game.world.centerY,e,t),s=i.x-200*this.xDirection*this.game.rnd.integerInRange(1,2),o=i.y-100;this.game.add.tween(i).to({x:s,y:o},1e3,Phaser.Easing.Default,!0,0,0,!1).onComplete.add(function(){i.destroy()},this)}this.xDirection*=-1},t.prototype.showComboText=function(t){for(var e={font:"30px saranaigamebold",fill:"#00FF00",align:"center"},i="Combo Lost",s=["goodJob","congratulations","greatWork"],o=this.game.add.audio(s[this.game.rnd.integerInRange(0,2)],.8,!1),a=this.comboText.length-1;a>=0;a--)if(this.comboText[a].level<t){i=this.comboText[a].text,this.game.conf.ISMUSICENABLED&&o.play();break}{var n=this.game.add.text(this.game.world.centerX,this.game.world.centerY,i,e),h=n.x-200*this.xDirection*this.game.rnd.integerInRange(1,2),r=n.y-100;this.game.add.tween(n).to({x:h,y:r},1e3,Phaser.Easing.Default,!0,0,0,!1).onComplete.add(function(){n.destroy()},this)}this.xDirection*=-1},t.prototype.showCustomText=function(t){{var e={font:"30px saranaigamebold",fill:"#FDCD08",align:"center"},i=this.game.add.text(this.game.world.centerX,this.game.world.centerY,t,e),s=i.x-200*this.xDirection*this.game.rnd.integerInRange(1,2),o=i.y-100;this.game.add.tween(i).to({x:s,y:o},1e3,Phaser.Easing.Default,!0,0,0,!1).onComplete.add(function(){i.destroy()},this)}this.xDirection*=-1},t.prototype.showNewRecordText=function(t){void 0===t&&(t="NEW RECORD!");{var e={font:"50px saranaigamebold",fill:"#27E5E8",align:"center"},i=this.game.add.text(this.game.world.centerX,this.game.world.centerY,t,e),s=i.x-200*this.xDirection*this.game.rnd.integerInRange(1,2),o=i.y-100;this.game.add.tween(i).to({x:s,y:o},1e3,Phaser.Easing.Default,!0,0,0,!1).onComplete.add(function(){i.destroy()},this)}this.xDirection*=-1},t}());t.InfoTextManager=e}(TextInfo||(TextInfo={}));var Superhero;!function(t){var e=function(){function e(t,e){this.shieldLastCount=0,this.livesLastCount=0,this.nukesLastCount=0,this.warpLastCount=0,this.rocketLastCount=0,this.scoreCount=0,this.brokeRecord=!1,this.recordSaved=!1,this.game=t,this.player=e,this.infoText=new TextInfo.InfoTextManager(this.game),"level1"==this.game.state.current&&(this.game.state.states.Level1.collectableManager.onCollect.removeAll(),this.game.state.states.Level1.collectableManager.onCollect.add(this.dispatchPraiseText,this),this.game.state.states.Level1.hero.onHit.removeAll(),this.game.state.states.Level1.hero.onHit.add(this.dispatchCriticizeText,this)),this.createTimer(),this.createScoreBoard(),this.createPlayerInterface(),this.createPowerUpInterface()}return e.prototype.update=function(){this.updateShields(),this.updateLives(),this.updatePUPIcons(),this.updateCooldowns(),this.comboText.setText(Math.floor(this.player.comboLevel)>0?"combo X"+Math.floor(this.player.comboLevel+1):""),this.scoreCount>this.game.conf.TOPSCORE&&!this.brokeRecord&&(this.brokeRecord=!0,this.infoText.showNewRecordText()),this.player.sprite.alive||this.popUpMenu()},e.prototype.popUpMenu=function(){this.player.sprite.alive?this.menu.reset(this.game.world.centerX,this.game.world.centerY):this.menuDisabled.reset(this.game.world.centerX,this.game.world.centerY),this.game.world.bringToTop(this.menu),this.recordSaved||this.game.conf.save(),this.recordSaved=!0,this.timer.pause(),this.game.paused=!0,this.game.sound.pauseAll(),this.game.input.onDown.add(this.unPause,this)},e.prototype.dispatchCriticizeText=function(){this.infoText.showBadJobText()},e.prototype.dispatchPraiseText=function(){this.infoText.showGoodJobText()},e.prototype.createTimer=function(){var t=this.game.add.sprite(this.game.world.centerX+60,10,"puinfo");t.scale.setTo(-.5,.5),t.inputEnabled=!0,t.events.onInputDown.add(this.popUpMenu,this),this.pauseButton=this.game.add.sprite(this.game.world.centerX+15,25,"pauseBtn"),this.pauseButton.inputEnabled=!0,this.pauseButton.scale.setTo(1.5,1.5),this.menu=this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"menuBack"),this.menu.anchor.setTo(.5,.5),this.menu.inputEnabled=!0,this.menuDisabled=this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"menuBackDisabled"),this.menuDisabled.anchor.setTo(.5,.5),this.menuDisabled.inputEnabled=!0,this.menu.kill(),this.menuDisabled.kill(),this.timer=this.game.time.create(!1),this.pauseButton.events.onInputDown.add(this.popUpMenu,this);var e={font:"25px saranaigamebold",fill:"#FFFFFF",align:"center"};this.timerText=this.game.add.text(this.game.world.centerX-60,40,"0:00",e),this.timerText.anchor.set(0,.5),this.timer.loop(Phaser.Timer.SECOND,this.updateTime,this),this.timer.start()},e.prototype.unPause=function(t){var e=this.player.sprite.alive?this.menu:this.menuDisabled,i=this.game.world.centerX-e.width/2,s=this.game.world.centerX+e.width/2,o=this.game.world.centerY-e.height/2,a=this.game.world.centerY+e.height/2;if(this.game.sound.resumeAll(),t.x>i&&t.x<s&&t.y>o&&t.y<a){var n=(t.x-i,t.y-o),h=Math.floor((n/4-28)/22)+1;switch(h){case 1:if(!this.player.sprite.alive)return;this.game.input.onDown.remove(this.unPause,this),e.kill(),this.timer.resume(),this.game.paused=!1;break;case 2:this.game.input.onDown.remove(this.unPause,this),this.timer.resume(),this.game.paused=!1,this.game.state.restart(!0,!1);break;case 3:this.game.input.onDown.remove(this.unPause,this),this.timer.resume(),this.game.paused=!1,this.game.sound.stopAll(),this.game.state.start("Menu",!0,!1);break;default:if(!this.player.sprite.alive)return;this.game.input.onDown.remove(this.unPause,this),this.timer.resume(),this.game.paused=!1,e.kill()}}else{if(!this.player.sprite.alive)return;e.kill(),this.game.input.onDown.remove(this.unPause,this),this.game.paused=!1,this.timer.resume()}},e.prototype.createScoreBoard=function(){var t={font:"30px saranaigamebold",fill:"#FDCD08",align:"center"};this.scoreText=this.game.add.text(20,50,"",t)},e.prototype.scoreUp=function(t){this.scoreCount+=t*Math.floor(this.player.comboLevel+1),this.scoreText.setText(this.scoreCount.toString())},e.prototype.updateCooldowns=function(){this.updateNukeCooldown(),this.updateWarpCooldown()},e.prototype.updateNukeCooldown=function(){var t=this.game.time.elapsedSecondsSince(this.player.nukeCoolDown),e=30;if(t>e)return this.nukesIcon.mask.atRest||this.nukesIcon.mask.drawCircleAtSelf(),void(this.nukesIcon.mask.atRest=!0);var i=t/e;this.nukesIcon.mask.drawWithFill(i,16777215,.5),this.nukesIcon.mask.atRest=!1},e.prototype.updateWarpCooldown=function(){var t=this.game.time.elapsedSecondsSince(this.player.warpCoolDown),e=30;if(t>e)return this.warpIcon.mask.atRest||this.warpIcon.mask.drawCircleAtSelf(),void(this.warpIcon.mask.atRest=!0);var i=t/e;this.warpIcon.mask.drawWithFill(i,16777215,.5),this.warpIcon.mask.atRest=!1},e.prototype.updateTime=function(){var t=Math.floor(this.timer.seconds/60),e=Math.floor(this.timer.seconds-60*t);this.timerText.setText(t.toString()+":"+("0"+e.toString()).slice(-2))},e.prototype.updateShields=function(){this.shieldLastCount!=this.player.shield&&(this.shieldLastCount>this.player.shield?this.killNextShield():this.reviveNextShield(),this.shieldLastCount=this.player.shield)},e.prototype.updateLives=function(){this.livesText.setText("x"+this.player.lives.toString())},e.prototype.updatePUPIcons=function(){this.updateNukes(),this.updateRockets(),this.updateWarps()},e.prototype.updateNukes=function(){this.nukesLastCount!=this.player.nukes&&(this.nukesText.setText(this.player.nukes.toString()),this.player.nukes>0?(this.nukesIcon.alpha=1,this.nukesText.alpha=1,this.game.gamepad.buttonPad.button2.sprite.alpha=1):(this.nukesIcon.alpha=.3,this.nukesText.alpha=.3,this.game.gamepad.buttonPad.button2.sprite.alpha=.3),this.nukesLastCount=this.player.nukes)},e.prototype.updateRockets=function(){this.rocketLastCount!=this.player.bombs&&(this.rocketText.setText(this.player.bombs.toString()),this.player.bombs>0?(this.rocketIcon.alpha=1,this.rocketText.alpha=1,this.game.gamepad.buttonPad.button4.sprite.alpha=1):(this.rocketIcon.alpha=.3,this.rocketText.alpha=.3,this.game.gamepad.buttonPad.button4.sprite.alpha=.3),this.rocketLastCount=this.player.bombs)},e.prototype.updateWarps=function(){this.warpLastCount!=this.player.timeWarps&&(this.warpText.setText(this.player.timeWarps.toString()),this.player.timeWarps>0?(this.warpIcon.alpha=1,this.warpText.alpha=1,this.game.gamepad.buttonPad.button3.sprite.alpha=1):(this.warpIcon.alpha=.3,this.warpText.alpha=.3,this.game.gamepad.buttonPad.button3.sprite.alpha=.3),this.warpLastCount=this.player.timeWarps)},e.prototype.renderShieldIcons=function(t,e,i){for(var s=0;t>s;s++)this.shieldIcons[s]=this.game.add.sprite(e,i,"pups","shield_s"),this.shieldIcons[s].anchor.setTo(0,.5),e=e+this.shieldIcons[s].width+5,this.shieldLastCount+=1},e.prototype.reviveShieldIcon=function(t){for(var e=0,i=this.player.shield-1;t>e&&i>-1;i--)this.shieldIcons[i].revive(),this.shieldLastCount-=1,e+=1},e.prototype.killShieldIcon=function(t){for(var e=0,i=this.shieldIcons.length-1;t>e&&i>-1;i--)this.shieldIcons[i].kill(),this.shieldLastCount-=1,e+=1},e.prototype.killNextShield=function(){for(var t=0;t<this.shieldIcons.length;t++)if(!this.shieldIcons[t].alive&&t>0)return void this.shieldIcons[t-1].kill();this.shieldIcons[this.shieldIcons.length-1].kill()},e.prototype.reviveNextShield=function(){for(var t=0;t<this.shieldIcons.length;t++)if(!this.shieldIcons[t].alive)return void this.shieldIcons[t].revive()},e.prototype.createPlayerInterface=function(){var t=20,e=30,i={font:"20px saranaigamebold",fill:"#FDCD08",align:"center"};this.livesIcon=this.game.add.sprite(t,e,"pups","hero1_s"),this.livesIcon.anchor.setTo(0,.5),t=t+this.livesIcon.width+10,this.livesText=this.game.add.text(t,e+5,"",i),this.livesText.anchor.set(0,.5),this.livesLastCount=this.player.lives,t=t+this.livesText.width+10,this.shieldIcons=[],this.renderShieldIcons(3,t+20,e),this.killShieldIcon(3);var i={font:"40px saranaigamebold",fill:"#FDCD08",align:"center"};this.comboText=this.game.add.text(this.game.world.centerX,100,"",i),this.comboText.anchor.set(.5,.5)},e.prototype.createPowerUpInterface=function(){var e=this.game.width-50,i=15,s={font:"15px saranaigamebold",fill:"#FDCD08",align:"center"};this.nukesIcon=this.game.add.sprite(e,i,"pups","nuke_s"),this.nukesText=this.game.add.text(e+this.nukesIcon.width/2+1,i+33,this.player.nukes.toString(),s),this.nukesText.anchor.set(.5,0),this.nukesLastCount=this.player.nukes;var o=e+this.nukesIcon.width/2,a=i+this.nukesIcon.height/2,n=Math.max(this.nukesIcon.width,this.nukesIcon.height)/2;this.nukesIcon.mask=new t.PieMask(this.game,n,o,a),0==this.player.nukes&&(this.nukesIcon.alpha=.3,this.nukesText.alpha=.3,this.game.gamepad.buttonPad.button2.sprite.alpha=.3),e-=this.nukesIcon.width+10,this.warpIcon=this.game.add.sprite(e,i,"pups","clock_s"),this.warpText=this.game.add.text(e+this.warpIcon.width/2+1,i+33,this.player.timeWarps.toString(),s),this.warpText.anchor.set(.5,0),this.warpLastCount=this.player.timeWarps,o=e+this.warpIcon.width/2,a=i+this.warpIcon.height/2,n=Math.max(this.warpIcon.width,this.warpIcon.height)/2,this.warpIcon.mask=new t.PieMask(this.game,n,o,a),0==this.player.timeWarps&&(this.warpIcon.alpha=.3,this.warpText.alpha=.3,this.game.gamepad.buttonPad.button3.sprite.alpha=.3),e-=this.warpIcon.width+10,this.rocketIcon=this.game.add.sprite(e,i,"pups","rocket_s"),this.rocketText=this.game.add.text(e+this.rocketIcon.width/2+1,i+33,this.player.bombs.toString(),s),this.rocketText.anchor.set(.5,0),this.rocketLastCount=this.player.bombs,0==this.player.bombs&&(this.rocketIcon.alpha=.3,this.rocketText.alpha=.3,this.game.gamepad.buttonPad.button4.sprite.alpha=.3)},e}();t.UI=e}(Superhero||(Superhero={}));var Gamepads;!function(t){!function(t){t[t.HALF_LEFT=1]="HALF_LEFT",t[t.HALF_TOP=2]="HALF_TOP",t[t.HALF_RIGHT=3]="HALF_RIGHT",t[t.HALF_BOTTOM=4]="HALF_BOTTOM",t[t.TOP_LEFT=5]="TOP_LEFT",t[t.TOP_RIGHT=6]="TOP_RIGHT",t[t.BOTTOM_RIGHT=7]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=8]="BOTTOM_LEFT",t[t.ALL=9]="ALL"}(t.Sectors||(t.Sectors={}));var e=(t.Sectors,function(t){function e(e,i,s){void 0===s&&(s=!0),t.call(this,e,new PIXI.DisplayObject),this.imageGroup=[],this.doUpdate=!1,this.gamepadMode=!0,this.game=e,this.sector=i,this.gamepadMode=s,this.pointer=this.game.input.pointer1,this.imageGroup.push(this.game.add.sprite(0,0,"joystick_base")),this.imageGroup.push(this.game.add.sprite(0,0,"joystick_segment")),this.imageGroup.push(this.game.add.sprite(0,0,"joystick_knob")),this.imageGroup.forEach(function(t){t.anchor.set(.5),t.visible=!1,t.fixedToCamera=!0}),this.settings={maxDistanceInPixels:60,singleDirection:!1,"float":!0,analog:!0,topSpeed:200},this.cursors={up:!1,down:!1,left:!1,right:!1},this.speed={x:0,y:0},this.inputEnable()}return __extends(e,t),e.prototype.inputEnable=function(){this.game.input.onDown.add(this.createStick,this),this.game.input.onUp.add(this.removeStick,this),this.active=!0},e.prototype.inputDisable=function(){this.game.input.onDown.remove(this.createStick,this),this.game.input.onUp.remove(this.removeStick,this),this.active=!1},e.prototype.inSector=function(t){var e=t.position.y>this.game.height/2,i=t.position.y<this.game.height/2,s=t.position.x>this.game.width/2,o=t.position.x<this.game.width/2;return 9==this.sector?!0:1==this.sector&&o?!0:3==this.sector&&s?!0:4==this.sector&&e?!0:2==this.sector&&i?!0:5==this.sector&&i&&o?!0:6==this.sector&&i&&s?!0:7==this.sector&&e&&s?!0:8==this.sector&&e&&o?!0:!1},e.prototype.createStick=function(t){this.inSector(t)&&(this.pointer=t,this.imageGroup.forEach(function(t){t.visible=!0,t.bringToTop(),t.cameraOffset.x=this.pointer.worldX,t.cameraOffset.y=this.pointer.worldY},this),this.doUpdate=!0,this.initialPoint=this.pointer.position.clone())},e.prototype.removeStick=function(t){t.id==this.pointer.id&&(this.doUpdate=!1,this.imageGroup.forEach(function(t){t.visible=!1}),this.cursors.up=!1,this.cursors.down=!1,this.cursors.left=!1,this.cursors.right=!1,this.speed.x=0,this.speed.y=0)},e.prototype.receivingInput=function(){return this.cursors.up||this.cursors.down||this.cursors.left||this.cursors.right},e.prototype.preUpdate=function(){this.doUpdate&&this.setDirection()},e.prototype.setSingleDirection=function(){var t=this.initialPoint.distance(this.pointer.position),e=this.settings.maxDistanceInPixels,i=this.pointer.position.x-this.initialPoint.x,s=this.pointer.position.y-this.initialPoint.y;if(e>t)return this.cursors.up=!1,this.cursors.down=!1,this.cursors.left=!1,this.cursors.right=!1,this.speed.x=0,this.speed.y=0,void this.imageGroup.forEach(function(t,e){t.cameraOffset.x=this.initialPoint.x+i*e/(this.imageGroup.length-1),t.cameraOffset.y=this.initialPoint.y+s*e/(this.imageGroup.length-1)},this);Math.abs(i)>Math.abs(s)?(s=0,this.pointer.position.y=this.initialPoint.y):(i=0,this.pointer.position.x=this.initialPoint.x);var o=this.initialPoint.angle(this.pointer.position);t>e&&(i=Math.cos(o)*e,s=Math.sin(o)*e,this.settings["float"]&&(this.initialPoint.x=this.pointer.x-i,this.initialPoint.y=this.pointer.y-s)),this.speed.x=Math.round(Math.cos(o)*this.settings.topSpeed),this.speed.y=Math.round(Math.sin(o)*this.settings.topSpeed),o=180*o/Math.PI,this.cursors.up=-90==o,this.cursors.down=90==o,this.cursors.left=180==o,this.cursors.right=0==o,this.imageGroup.forEach(function(t,e){t.cameraOffset.x=this.initialPoint.x+i*e/(this.imageGroup.length-1),t.cameraOffset.y=this.initialPoint.y+s*e/(this.imageGroup.length-1)},this)},e.prototype.setDirection=function(){if(this.settings.singleDirection)return void this.setSingleDirection();var t=this.initialPoint.distance(this.pointer.position),e=this.settings.maxDistanceInPixels,i=this.pointer.position.x-this.initialPoint.x,s=this.pointer.position.y-this.initialPoint.y;if(!this.settings.analog&&e>t)return this.cursors.up=!1,this.cursors.down=!1,this.cursors.left=!1,this.cursors.right=!1,this.speed.x=0,this.speed.y=0,void this.imageGroup.forEach(function(t,e){t.cameraOffset.x=this.initialPoint.x+i*e/(this.imageGroup.length-1),t.cameraOffset.y=this.initialPoint.y+s*e/(this.imageGroup.length-1)},this);var o=this.initialPoint.angle(this.pointer.position);t>e&&(i=Math.cos(o)*e,s=Math.sin(o)*e,this.settings["float"]&&(this.initialPoint.x=this.pointer.x-i,this.initialPoint.y=this.pointer.y-s)),this.settings.analog?(this.speed.x=Math.round(i/e*this.settings.topSpeed),this.speed.y=Math.round(s/e*this.settings.topSpeed)):(this.speed.x=Math.round(Math.cos(o)*this.settings.topSpeed),this.speed.y=Math.round(Math.sin(o)*this.settings.topSpeed)),this.cursors.up=0>s,this.cursors.down=s>0,this.cursors.left=0>i,this.cursors.right=i>0,this.imageGroup.forEach(function(t,e){t.cameraOffset.x=this.initialPoint.x+i*e/(this.imageGroup.length-1),t.cameraOffset.y=this.initialPoint.y+s*e/(this.imageGroup.length-1)},this)},e.preloadAssets=function(t,e){t.load.image("joystick_base",e+"/joystick_base.png"),t.load.image("joystick_segment",e+"/joystick_segment.png"),t.load.image("joystick_knob",e+"/joystick_knob.png")},e}(Phaser.Plugin));t.Joystick=e}(Gamepads||(Gamepads={}));var Gamepads;!function(t){var e=function(t){function e(e,i,s,o,a,n){void 0===i&&(i=50),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===n&&(n=6),t.call(this,e,s/2,o/2),this.atRest=!1,this.game=e,this.radius=i,this.rotation=a,this.moveTo(this.x,this.y),this.sides=3>n?3:n,this.game.add.existing(this)}return __extends(e,t),e.prototype.drawCircleAtSelf=function(){this.drawCircle(this.x,this.y,2*this.radius)},e.prototype.drawWithFill=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=1),this.clear(),this.beginFill(e,i),this.draw(t),this.endFill()},e.prototype.lineToRadians=function(t,e){this.lineTo(Math.cos(t)*e+this.x,Math.sin(t)*e+this.y)},e.prototype.draw=function(t){this.moveTo(this.x,this.y);var e=this.radius;e/=Math.cos(1/this.sides*Math.PI);for(var i=Math.floor(t*this.sides),s=0;i>=s;s++)this.lineToRadians(s/this.sides*2*Math.PI+this.rotation,e);t*this.sides!=i&&this.lineToRadians(2*t*Math.PI+this.rotation,e)},e}(Phaser.Graphics);t.PieMask=e}(Gamepads||(Gamepads={}));var Gamepads;!function(t){!function(t){t[t.SINGLE=1]="SINGLE",t[t.TURBO=2]="TURBO",t[t.DELAYED_TURBO=3]="DELAYED_TURBO",t[t.SINGLE_THEN_TURBO=4]="SINGLE_THEN_TURBO",t[t.CUSTOM=5]="CUSTOM"}(t.ButtonType||(t.ButtonType={}));var e=(t.ButtonType,function(t){function e(e,i,s,o,a,n,h,r,l){void 0===h&&(h=4),t.call(this,e,new PIXI.DisplayObject),this.pressed=!1,this.game=e,this.type=h,this.sprite=this.game.add.sprite(i,s,o),this.width=r||this.sprite.width,this.height=l||this.sprite.height,this.sprite.inputEnabled=!0,this.cooldown={enabled:!1,seconds:0,timer:0},this.onPressedCallback=void 0==a?this.empty:a.bind(n),this.customCanTriggerCallback=this.empty,this.sprite.events.onInputDown.add(this.pressButton,this),this.sprite.events.onInputUp.add(this.releaseButton,this),this.sprite.anchor.setTo(1,1),this.active=!0}return __extends(e,t),e.prototype.empty=function(){return!0},e.prototype.enableCooldown=function(t){this.cooldown.enabled=!0,this.cooldown.seconds=t,this.cooldown.timer=this.game.time.time;var e=this.sprite.x-this.sprite.width/2,i=this.sprite.y-this.sprite.height/2,s=Math.max(this.sprite.width,this.sprite.height)/2;this.sprite.mask=new Superhero.PieMask(this.game,s,e,i)},e.prototype.disableCooldown=function(){this.cooldown.enabled=!1,this.sprite.mask.drawCircleAtSelf(),this.sprite.mask.atRest=!0},e.prototype.pressButton=function(){switch(this.type){case 1:this.triggerCallback();break;case 2:this.pressed=!0;break;case 3:this.timerId=setTimeout(function(){this.pressed=!0}.bind(this),300);break;case 4:this.triggerCallback(),this.timerId=setTimeout(function(){this.pressed=!0}.bind(this),300);break;default:this.pressed=!0}},e.prototype.releaseButton=function(){this.pressed=!1,clearTimeout(this.timerId)},e.prototype.triggerCallback=function(){this.canTriggerCallback()&&this.customCanTriggerCallback()&&(this.onPressedCallback(),this.cooldown.enabled&&(this.cooldown.timer=this.game.time.time,this.sprite.mask.atRest=!1))},e.prototype.setOnPressedCallback=function(t,e){this.onPressedCallback=t.bind(e)},e.prototype.isTriggerTimerUp=function(){var t=this.game.time.elapsedSecondsSince(this.cooldown.timer);return t>this.cooldown.seconds},e.prototype.canTriggerCallback=function(){return this.cooldown.enabled?this.isTriggerTimerUp():!0},e.prototype.updatePieMask=function(){if(!this.sprite.mask.atRest){if(this.isTriggerTimerUp())return void(this.sprite.mask.atRest||(this.sprite.mask.drawCircleAtSelf(),this.sprite.mask.atRest=!0));var t=this.game.time.elapsedSecondsSince(this.cooldown.timer),e=t/this.cooldown.seconds;this.sprite.mask.drawWithFill(e,16777215,1),this.sprite.mask.atRest=!1}},e.prototype.update=function(){this.pressed&&5!=this.type&&this.triggerCallback(),this.cooldown.enabled&&this.updatePieMask()},e}(Phaser.Plugin));t.Button=e}(Gamepads||(Gamepads={}));var Gamepads;!function(t){!function(t){t[t.ONE_FIXED=1]="ONE_FIXED",t[t.TWO_INLINE_X=2]="TWO_INLINE_X",t[t.TWO_INLINE_Y=3]="TWO_INLINE_Y",t[t.THREE_INLINE_X=4]="THREE_INLINE_X",t[t.THREE_INLINE_Y=5]="THREE_INLINE_Y",t[t.THREE_FAN=6]="THREE_FAN",t[t.FOUR_STACK=7]="FOUR_STACK",t[t.FOUR_INLINE_X=8]="FOUR_INLINE_X",t[t.FOUR_INLINE_Y=9]="FOUR_INLINE_Y",t[t.FOUR_FAN=10]="FOUR_FAN",t[t.FIVE_FAN=11]="FIVE_FAN"}(t.ButtonPadType||(t.ButtonPadType={}));var e=(t.ButtonPadType,function(e){function i(t,i,s){switch(e.call(this,t,new PIXI.DisplayObject),this.padding=10,this.game=t,this.type=i,this.buttonSize=s,this.type){case 1:this.initOneFixed();break;case 2:this.initTwoInlineX();break;case 4:this.initThreeInlineX();break;case 8:this.initFourInlineX();break;case 3:this.initTwoInlineY();break;case 5:this.initThreeInlineY();break;case 9:this.initFourInlineY();break;case 7:this.initFourStack();break;case 6:this.initThreeFan();break;case 10:this.initFourFan();break;case 11:this.initFiveFan()}}return __extends(i,e),i.prototype.initOneFixed=function(){var e=this.game.width-this.padding,i=this.game.height-this.padding;return this.button1=new t.Button(this.game,e,i,"button1"),this.game.add.plugin(this.button1),e},i.prototype.initTwoInlineX=function(){var e=this.initOneFixed(),i=this.game.height-this.padding;return e=e-this.buttonSize-this.padding,this.button2=new t.Button(this.game,e,i,"button2"),this.game.add.plugin(this.button2),e},i.prototype.initThreeInlineX=function(){var e=this.initTwoInlineX(),i=this.game.height-this.padding;return e=e-this.buttonSize-this.padding,this.button3=new t.Button(this.game,e,i,"button3"),this.game.add.plugin(this.button3),e},i.prototype.initFourInlineX=function(){var e=this.initThreeInlineX(),i=this.game.height-this.padding;return e=e-this.buttonSize-this.padding,this.button4=new t.Button(this.game,e,i,"button4"),this.game.add.plugin(this.button4),e},i.prototype.initTwoInlineY=function(){var e=this.game.width-this.padding,i=this.game.height-this.padding;return this.button1=new t.Button(this.game,e,i,"button1"),i=i-this.buttonSize-this.padding,this.button2=new t.Button(this.game,e,i,"button2"),this.game.add.plugin(this.button1),this.game.add.plugin(this.button2),i},i.prototype.initThreeInlineY=function(){var e=this.game.width-this.padding,i=this.initTwoInlineY();return i=i-this.buttonSize-this.padding,this.button3=new t.Button(this.game,e,i,"button3"),this.game.add.plugin(this.button3),i},i.prototype.initFourInlineY=function(){var e=this.game.width-this.padding,i=this.initThreeInlineY();return i=i-this.buttonSize-this.padding,this.button4=new t.Button(this.game,e,i,"button4"),this.game.add.plugin(this.button4),i},i.prototype.initFourStack=function(){var e=this.game.width-this.padding,i=this.game.height-this.padding;this.button1=new t.Button(this.game,e,i,"button1"),i=i-this.buttonSize-this.padding,this.button2=new t.Button(this.game,e,i,"button2");var e=e-this.buttonSize-this.padding,i=this.game.height-this.padding;this.button3=new t.Button(this.game,e,i,"button3"),i=i-this.buttonSize-this.padding,this.button4=new t.Button(this.game,e,i,"button4"),this.game.add.plugin(this.button1),this.game.add.plugin(this.button2),this.game.add.plugin(this.button3),this.game.add.plugin(this.button4)},i.prototype.toRadians=function(t){return t*(Math.PI/180)},i.prototype.toDegrees=function(t){return t*(180/Math.PI)},i.prototype.initThreeFan=function(){var e=this.game.width-3*this.padding,i=this.game.height-3*this.padding,s=1.5*this.buttonSize,o=50,a=175;a=this.toRadians(a),o=this.toRadians(o);var n=e+Math.cos(a)*s,h=i+Math.sin(a)*s;this.button1=new t.Button(this.game,n,h,"button1"),this.button1.sprite.scale.setTo(.7),n=e+Math.cos(a+o)*s,h=i+Math.sin(a+o)*s,this.button2=new t.Button(this.game,n,h,"button2"),this.button2.sprite.scale.setTo(.7),n=e+Math.cos(a+2*o)*s,h=i+Math.sin(a+2*o)*s,this.button3=new t.Button(this.game,n,h,"button3"),this.button3.sprite.scale.setTo(.7),this.game.add.plugin(this.button1),this.game.add.plugin(this.button2),this.game.add.plugin(this.button3)},i.prototype.initFourFan=function(){var e=this.game.width-3*this.padding,i=this.game.height-3*this.padding,s=1.5*this.buttonSize,o=50,a=175;a=this.toRadians(a),o=this.toRadians(o),this.button1=new t.Button(this.game,e-this.padding,i-this.padding,"button1"),this.button1.sprite.scale.setTo(1.3);var n=e+Math.cos(a)*s,h=i+Math.sin(a)*s;this.button2=new t.Button(this.game,n,h,"button2"),this.button2.sprite.scale.setTo(.8),n=e+Math.cos(a+o)*s,h=i+Math.sin(a+o)*s,this.button3=new t.Button(this.game,n,h,"button3"),this.button3.sprite.scale.setTo(.8),n=e+Math.cos(a+2*o)*s,h=i+Math.sin(a+2*o)*s,this.button4=new t.Button(this.game,n,h,"button4"),this.button4.sprite.scale.setTo(.8),this.game.add.plugin(this.button1),this.game.add.plugin(this.button2),this.game.add.plugin(this.button3),this.game.add.plugin(this.button4)},i.prototype.initFiveFan=function(){var e=this.game.width-3*this.padding,i=this.game.height-3*this.padding,s=1.5*this.buttonSize,o=100/3,a=175;a=this.toRadians(a),o=this.toRadians(o),this.button1=new t.Button(this.game,e,i,"button1"),this.button1.sprite.scale.setTo(1.2);var n=e+Math.cos(a)*s,h=i+Math.sin(a)*s;this.button2=new t.Button(this.game,n,h,"button2"),this.button2.sprite.scale.setTo(.7),n=e+Math.cos(a+o)*s,h=i+Math.sin(a+o)*s,this.button3=new t.Button(this.game,n,h,"button3"),this.button3.sprite.scale.setTo(.7),n=e+Math.cos(a+2*o)*s,h=i+Math.sin(a+2*o)*s,this.button4=new t.Button(this.game,n,h,"button4"),this.button4.sprite.scale.setTo(.7),n=e+Math.cos(a+3*o)*s,h=i+Math.sin(a+3*o)*s,this.button5=new t.Button(this.game,n,h,"button5"),this.button5.sprite.scale.setTo(.7),this.game.add.plugin(this.button1),this.game.add.plugin(this.button2),this.game.add.plugin(this.button3),this.game.add.plugin(this.button4),this.game.add.plugin(this.button5)},i.preloadAssets=function(t,e){t.load.image("button1",e+"/button1.png"),t.load.image("button2",e+"/button2.png"),t.load.image("button3",e+"/button3.png"),t.load.image("button4",e+"/button4.png"),t.load.image("button5",e+"/button5.png")},i}(Phaser.Plugin));t.ButtonPad=e}(Gamepads||(Gamepads={}));var Gamepads;!function(t){!function(t){t[t.TOUCH=1]="TOUCH",t[t.SWIPE=2]="SWIPE"}(t.TouchInputType||(t.TouchInputType={}));var e=(t.TouchInputType,function(t){function e(e,i,s){void 0===s&&(s=2),t.call(this,e,new PIXI.DisplayObject),this.screenPressed=!1,this.swipeThreshold=100,this.game=e,this.sector=i,this.touchType=s,this.pointer=this.game.input.pointer1,this.swipeDownCallback=this.empty,this.swipeLeftCallback=this.empty,this.swipeRightCallback=this.empty,this.swipeUpCallback=this.empty,this.onTouchDownCallback=this.empty,this.onTouchReleaseCallback=this.empty,this.swipe={up:!1,down:!1,left:!1,right:!1},this.inputEnable()}return __extends(e,t),e.prototype.inputEnable=function(){this.game.input.onDown.add(this.startGesture,this),this.game.input.onUp.add(this.endGesture,this),this.active=!0},e.prototype.inputDisable=function(){this.game.input.onDown.remove(this.startGesture,this),this.game.input.onUp.remove(this.endGesture,this),this.active=!1},e.prototype.inSector=function(t){var e=t.position.y>this.game.height/2,i=t.position.y<this.game.height/2,s=t.position.x>this.game.width/2,o=t.position.x<this.game.width/2;return 9==this.sector?!0:1==this.sector&&o?!0:3==this.sector&&s?!0:4==this.sector&&e?!0:2==this.sector&&i?!0:5==this.sector&&i&&o?!0:6==this.sector&&i&&s?!0:7==this.sector&&e&&s?!0:8==this.sector&&e&&o?!0:!1},e.prototype.startGesture=function(t){this.inSector(t)&&(this.touchTimer=this.game.time.time,this.screenPressed=!0,this.pointer=t,this.initialPoint=this.pointer.position.clone(),1==this.touchType&&this.onTouchDownCallback())},e.prototype.endGesture=function(t){if(t.id==this.pointer.id){this.screenPressed=!1;
var e=this.game.time.elapsedSecondsSince(this.touchTimer);if(1==this.touchType)return void this.onTouchReleaseCallback(e);var i=this.initialPoint.distance(this.pointer.position);if(!(i<this.swipeThreshold)){var s=this.pointer.position.x-this.initialPoint.x,o=this.pointer.position.y-this.initialPoint.y;Math.abs(s)>Math.abs(o)?this.pointer.position.y=this.initialPoint.y:this.pointer.position.x=this.initialPoint.x;var a=this.initialPoint.angle(this.pointer.position);a=180*a/Math.PI,this.swipe.up=-90==a,this.swipe.down=90==a,this.swipe.left=180==a,this.swipe.right=0==a,this.swipe.up&&this.swipeUpCallback(),this.swipe.down&&this.swipeDownCallback(),this.swipe.left&&this.swipeLeftCallback(),this.swipe.right&&this.swipeRightCallback()}}},e.prototype.empty=function(){},e.preloadAssets=function(t,e){t.load.image("joystick_base",e+"/joystick_base.png"),t.load.image("joystick_segment",e+"/joystick_segment.png"),t.load.image("joystick_knob",e+"/joystick_knob.png")},e}(Phaser.Plugin));t.TouchInput=e}(Gamepads||(Gamepads={}));var Gamepads;!function(t){!function(t){t[t.SINGLE_STICK=1]="SINGLE_STICK",t[t.DOUBLE_STICK=2]="DOUBLE_STICK",t[t.STICK_BUTTON=3]="STICK_BUTTON",t[t.CORNER_STICKS=4]="CORNER_STICKS",t[t.GESTURE_BUTTON=5]="GESTURE_BUTTON",t[t.GESTURE=6]="GESTURE"}(t.GamepadType||(t.GamepadType={}));var e=(t.GamepadType,function(e){function i(t,i,s){switch(e.call(this,t,new PIXI.DisplayObject),this.test=0,this.game=t,i){case 2:this.initDoublStick();break;case 1:this.initSingleStick();break;case 3:this.initStickButton(s);break;case 4:this.initCornerSticks();break;case 5:this.initGestureButton(s);break;case 6:this.initGesture()}}return __extends(i,e),i.prototype.initDoublStick=function(){this.stick1=new t.Joystick(this.game,1),this.stick2=new t.Joystick(this.game,3),this.game.add.plugin(this.stick1,null),this.game.add.plugin(this.stick2,null)},i.prototype.initCornerSticks=function(){this.game.input.addPointer(),this.game.input.addPointer(),this.stick1=new t.Joystick(this.game,8),this.stick2=new t.Joystick(this.game,5),this.stick3=new t.Joystick(this.game,6),this.stick4=new t.Joystick(this.game,7),this.game.add.plugin(this.stick1,null),this.game.add.plugin(this.stick2,null),this.game.add.plugin(this.stick3,null),this.game.add.plugin(this.stick4,null)},i.prototype.initSingleStick=function(){this.stick1=new t.Joystick(this.game,9),this.game.add.plugin(this.stick1,null)},i.prototype.initStickButton=function(e){this.stick1=new t.Joystick(this.game,1),this.game.add.plugin(this.stick1,null),this.buttonPad=new t.ButtonPad(this.game,e,100)},i.prototype.initGestureButton=function(e){this.touchInput=new t.TouchInput(this.game,1),this.buttonPad=new t.ButtonPad(this.game,e,100)},i.prototype.initGesture=function(){this.touchInput=new t.TouchInput(this.game,9)},i.preloadAssets=function(e,i){t.Joystick.preloadAssets(e,i),t.ButtonPad.preloadAssets(e,i)},i}(Phaser.Plugin));t.GamePad=e}(Gamepads||(Gamepads={}));var Superhero;!function(t){!function(t){t[t.STEADY=0]="STEADY",t[t.PATROL=1]="PATROL"}(t.EnemyState||(t.EnemyState={}));var e=(t.EnemyState,function(){function t(t,e){this.game=t,this.hero=e,this.gamepad=this.game.gamepad,this.fireButton=this.gamepad.buttonPad.button1,this.nukeButton=this.gamepad.buttonPad.button2,this.warpButton=this.gamepad.buttonPad.button3,this.bombButton=this.gamepad.buttonPad.button4,this.heroStick=this.gamepad.stick1,this.fxEnabled=this.game.conf.ISMUSICENABLED,this.musicEnabled=this.game.conf.ISMUSICENABLED}return t.prototype.update=function(){return null},t.prototype.enterState=function(){},t.prototype.exitState=function(){},t}()),i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.update=function(){if(this.hero.sprite.alive){if(!this.heroStick)return new o(this.game,this.hero);if(this.heroStick.receivingInput())return new s(this.game,this.hero)}return this},e.prototype.enterState=function(){},e.prototype.exitState=function(){},e}(e);t.StateIdle=i;var s=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.update=function(){if(this.hero.sprite.alive){if((Math.abs(this.heroStick.speed.x)>0||Math.abs(this.heroStick.speed.y)>0)&&this.hero.move(this.heroStick.speed),this.hero.sprite.play("flystill"),this.heroStick.cursors.right)return new a(this.game,this.hero);if(!this.heroStick.receivingInput())return new i(this.game,this.hero)}return this},e.prototype.enterState=function(){},e.prototype.exitState=function(){},e}(e);t.StateFly=s;var o=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.update=function(){return this.hero.sprite.alive&&(this.hero.sprite.play("flystill"),this.hero.sprite.body.velocity.y=-50,this.hero.sprite.body.velocity.x=190),this},e.prototype.enterState=function(){},e.prototype.exitState=function(){},e}(e);t.StateIntroFly=o;var a=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.update=function(){if(this.hero.sprite.alive){if(this.hero.sprite.play("fly"),(Math.abs(this.heroStick.speed.x)>0||Math.abs(this.heroStick.speed.y)>0)&&this.hero.move(this.heroStick.speed),!this.heroStick.receivingInput())return new i(this.game,this.hero);if(!this.heroStick.cursors.right)return new s(this.game,this.hero)}return this},e.prototype.enterState=function(){},e.prototype.exitState=function(){this.hero.stop()},e}(e);t.StateSprint=a;var n=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.patrol=function(t){this.tween=this.game.add.tween(this.hero.sprite),"miniBoss"==this.hero.sprite.key?this.tween.to({y:this.game.world.y},3e3,Phaser.Easing.Linear.None,!0,0,-1,!0):150==t?this.tween.to({y:this.game.world.centerY-50},this.game.conf.ENEMIES.patrolTweenSpeed,Phaser.Easing.Linear.None,!0,0,-1,!0):150==t?this.tween.to({y:this.game.world.centerY-50},this.game.conf.ENEMIES.patrolTweenSpeed,Phaser.Easing.Linear.None,!0,0,-1,!0):this.tween.to({y:this.game.world.centerY+50},this.game.conf.ENEMIES.patrolTweenSpeed,Phaser.Easing.Linear.None,!0,0,-1,!0)},e.prototype.engage=function(){this.hero.sirenSound.loop=!1,this.hero.missileSound.isPlaying||this.fxEnabled&&this.hero.missileSound.play(),this.stopPatrol(),this.hero.sprite.alpha=1,this.hero.sprite.body.enable=!0,this.hero.sprite.body.velocity.x=-1e3,this.hero.sprite.checkWorldBounds=!0,this.hero.sprite.outOfBoundsKill=!0},e.prototype.startWarning=function(){this.hero.sirenSound.loop=!0,this.fxEnabled&&this.hero.warningSound.play(),this.fxEnabled&&this.hero.sirenSound.play(),this.hero.sprite.animations.play("flystill"),this.hero.sprite.body.enable=!1,this.hero.sprite.alpha=0,this.tween=this.game.add.tween(this.hero.sprite),this.tween.to({alpha:1},500,Phaser.Easing.Linear.None,!0,0,1e3,!0)},e.prototype.resumePatrol=function(){this.tween&&this.hero.isPatrolling&&this.tween.resume()},e.prototype.stopPatrol=function(){this.tween&&this.tween.stop()},e.prototype.pausePatrol=function(){this.tween&&this.tween.pause()},e.prototype.update=function(){return this.hero.sprite.alive&&this.hero.fire(),this},e.prototype.enterState=function(){},e.prototype.exitState=function(){},e}(e);t.StateEnemyHostile=n;var h=function(t){function e(){t.apply(this,arguments),this.isMoving=!0}return __extends(e,t),e.prototype.update=function(){return this.hero.sprite.animations.currentAnim.isFinished&&(this.hero.sprite.animations.play("run"),this.isMoving||(this.hero.sprite.animations.paused=!0)),this},e.prototype.enterState=function(){this.hero.sprite.play("run")},e.prototype.exitState=function(){},e}(e);t.StateRun=h}(Superhero||(Superhero={}));var Collectables;!function(t){var e=function(t){function e(e,i){t.call(this,e,100,100,"pupanim",i),this.initPhysics(),this.loadAnimation(),this.loadSound()}return __extends(e,t),e.prototype.loadAnimation=function(){},e.prototype.loadSound=function(){},e.prototype.playSound=function(){this.fxEnabled=this.game.conf.ISMUSICENABLED,this.fxEnabled&&this.collectSound.play()},e.prototype.playAnimation=function(){this.animations.play("main")},e.prototype.initPhysics=function(){this.game.physics.enable(this,Phaser.Physics.ARCADE),this.alive=!1,this.visible=!1,this.checkWorldBounds=!0,this.outOfBoundsKill=!0},e.prototype.spawnAt=function(t,e){this.scale.setTo(.5),this.reset(t,e),this.resetFloatation()},e.prototype.resetFloatation=function(t,e){void 0===t&&(t=10),void 0===e&&(e=!0),this.body.velocity.x=t,e&&this.game.add.tween(this).to({y:"+50"},1500,Phaser.Easing.Sinusoidal.InOut,!0,0,-1,!0)},e.prototype.collect=function(){this.playSound()},e.prototype.overlapWithChar=function(t){return this.game.physics.arcade.overlap(t.sprite,this)?(this.collect(t),this.kill(),!0):!1},e}(Phaser.Sprite);t.BaseCollectable=e;var i=function(t){function e(e){t.call(this,e,"bullet")}return __extends(e,t),e.prototype.collect=function(t){t.firePower<5&&(t.firePower+=1,this.game.state.states.Level1.ui.infoText.showCustomText("Fire Power!"),this.playSound())},e.prototype.loadAnimation=function(){this.animations.add("main",["bullet1","bullet2"],3,!0,!1)},e.prototype.loadSound=function(){this.collectSound=this.game.add.audio("bulletCollect")},e}(e);t.ImproveFirePower=i;var s=function(t){function e(e){t.call(this,e,"shield")}return __extends(e,t),e.prototype.collect=function(t){t.shield<3&&(t.shield+=1,t.renderShield(),this.game.state.states.Level1.ui.infoText.showCustomText("Shield On!"),this.playSound())},e.prototype.loadAnimation=function(){this.animations.add("main",["shield1","shield2","shield3","shield4","shield5"],4,!0,!1)},e.prototype.loadSound=function(){this.collectSound=this.game.add.sound("shieldCollect",1)},e}(e);t.ImprovedShield=s;var o=function(t){function e(e){t.call(this,e,"nuke")}return __extends(e,t),e.prototype.collect=function(t){t.nukes+=1,this.game.state.states.Level1.ui.infoText.showCustomText("Nuke Collected!"),this.playSound()},e.prototype.loadAnimation=function(){this.animations.add("main",["nuke1","nuke2","nuke3","nuke4","nuke5","nuke6"],5,!0,!1)},e.prototype.loadSound=function(){this.collectSound=this.game.add.audio("nukeCollect")},e}(e);t.NukeBomb=o;var a=function(t){function e(e){t.call(this,e,"clock")}return __extends(e,t),e.prototype.collect=function(t){t.timeWarps+=1,this.game.state.states.Level1.ui.infoText.showCustomText("Time Warp Collected"),this.playSound()},e.prototype.loadAnimation=function(){this.animations.add("main",["clock1","clock2","clock3","clock4","clock5","clock6"],5,!0,!1)},e.prototype.loadSound=function(){this.collectSound=this.game.add.audio("timeWarpCollect")},e}(e);t.TimeWarp=a;var n=function(t){function e(e){t.call(this,e,"diamond")}return __extends(e,t),e.prototype.collect=function(t){t.coins+=10,this.playSound()},e.prototype.loadAnimation=function(){},e}(e);t.Diamond=n;var h=function(t){function e(e){t.call(this,e,"star")}return __extends(e,t),e.prototype.collect=function(t){t.immunity=!0,this.game.state.states.Level1.ui.infoText.showCustomText("Inmune!"),this.playSound()},e.prototype.loadAnimation=function(){},e}(e);t.Immunity=h;var r=function(t){function e(e){t.call(this,e,"rocket")}return __extends(e,t),e.prototype.collect=function(t){t.bombs+=1,this.game.state.states.Level1.ui.infoText.showCustomText("Rocket Collected!"),this.playSound()},e.prototype.loadAnimation=function(){this.animations.add("main",["rocket1","rocket2"],6,!0,!1)},e.prototype.loadSound=function(){this.collectSound=this.game.add.audio("rocketCollect")},e}(e);t.Bomb=r;var l=function(t){function e(e){t.call(this,e,"hero1")}return __extends(e,t),e.prototype.collect=function(t){t.lives+=1,this.game.state.states.Level1.ui.infoText.showCustomText("1 UP"),this.playSound()},e.prototype.loadAnimation=function(){this.animations.add("main",["head1","head2","head3","head4","head5"],6,!0,!1)},e.prototype.loadSound=function(){this.collectSound=this.game.add.audio("extraLifeCollect")},e}(e);t.Lives=l}(Collectables||(Collectables={}));var Superhero;!function(t){!function(t){t[t.LEFT=-1]="LEFT",t[t.RIGHT=1]="RIGHT"}(t.Facing||(t.Facing={}));var e=(t.Facing,function(){function e(e,i,s,o){this.soundEnabled=!0,this.fxEnabled=!0,this.shootDelay=200,this.allowFingerMargin=!0,this.firePower=1,this.nukes=0,this.timeWarps=0,this.immunity=!1,this.bombs=0,this.shield=0,this.lives=3,this.coins=0,this.nukeCoolDown=0,this.warpCoolDown=0,this.respawnDelay=5e3,this.bulletVelocity=1e3,this.allowGravity=!1,this.comboLevel=0,this.game=e,this.floor=this.game.height-80,this._state=new t.StateIdle(e,this),this.facing=-1,this.allowFingerMargin=!1,this.onHit=new Phaser.Signal,this.soundEnabled=this.game.conf.ISMUSICENABLED,this.fxEnabled=this.game.conf.ISMUSICENABLED,this.initSprite(i,s,o),this.initPhysics(),this.addAnimations(),this.initBullets(),this.startChar(),this.initAudio()}return e.prototype.startChar=function(){this.fuel=2e3,this.maxFuel=2e3,this.fuelTimer=this.game.time.time,this.bulletTimer=this.game.time.time,this.nukeCoolDown=this.game.time.time,this.warpCoolDown=this.game.time.time,this.sprite.play(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].idleAnimation),this.setIdleCallback(this.flyStill)},e.prototype.initAudio=function(){this.hitSound=this.game.add.audio(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].hitSound,this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].hitSoundVolume,!1),this.fireSound=this.game.add.audio(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].fireSound,this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].fireVolume,!1)},e.prototype.initSprite=function(t,e,i){this.sprite=this.game.add.sprite(e,i,t,this.game.conf.CHARACTERSCOLLECTION[t].mainSprite),this.sprite.anchor.setTo(this.game.conf.CHARACTERSCOLLECTION[t].anchor.x,this.game.conf.CHARACTERSCOLLECTION[t].anchor.y),this.sprite.scale.setTo(this.game.conf.CHARACTERSCOLLECTION[t].scale),this.game.conf.CHARACTERSCOLLECTION[t].diesOutOfBounds&&(this.sprite.checkWorldBounds=!0,this.sprite.outOfBoundsKill=!0)},e.prototype.initPhysics=function(){this.game.physics.enable(this.sprite,Phaser.Physics.ARCADE),this.sprite.body.collideWorldBounds=!0,this.sprite.body.gravity.y=this.game.conf.PHYSICS.player.gravity.y,this.sprite.body.drag.x=this.game.conf.PHYSICS.player.drag,this.sprite.body.drag.y=this.game.conf.PHYSICS.player.drag},e.prototype.moveLeft=function(){this.sprite.body.velocity.x=-500},e.prototype.sprint=function(){this.sprite.play("fly"),this.sprite.body.velocity.x=800},e.prototype.descend=function(){this.sprite.y<this.floor-this.sprite.height&&(this.sprite.y+=5)},e.prototype.climb=function(){this.sprite.body.velocity.y=-500},e.prototype.jump=function(){this.sprite.alive&&this.sprite.body.touching.down&&(this.sprite.body.velocity.y=-650)},e.prototype.flyStill=function(){this.sprite.animations.currentAnim.isFinished&&this.sprite.play("flystill")},e.prototype.run=function(){this.sprite.animations.currentAnim.isFinished&&this.sprite.play("run")},e.prototype.move=function(t){this.allowFingerMargin&&this.sprite.x<=this.game.width/2&&t.x<0&&(t.x=0),this.sprite.body.velocity.x=t.x*this.game.time.slowMotion,this.fuel&&(this.sprite.body.velocity.y=t.y*this.game.time.slowMotion)},e.prototype.stop=function(){this.sprite.animations.play("stop").onComplete.add(function(){this.sprite.animations.play("flystill")},this)},e.prototype.shootTimeUp=function(){var t=this.bulletTimer;"Intro"!=sh.state.getCurrentState().key&&"hero1"!=this.sprite.key&&sh.state.states.Level1.hero.timewarpActive&&(t=2*t);var e=this.game.time.elapsedSince(t);return!(e<this.shootDelay)},e.prototype.okToShoot=function(){return this.sprite.alive&&("shoot"!=this.sprite.animations.currentAnim.name||this.sprite.animations.currentAnim.isFinished)?!0:!1},e.prototype.canShoot=function(){return this.shootTimeUp()&&this.okToShoot()},e.prototype.fire=function(){if(this.canShoot()){this.sprite.animations.play("shoot");for(var t=0;t<this.firePower;t++){var e=this.bullets.getFirstDead();e||(e=this.createNewBullet()),e.anchor.setTo(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.anchor.x,this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.anchor.y),this.playFireSound(),e.reset(this.sprite.x+40*this.facing,this.sprite.y+(10*t+1)),e.checkWorldBounds=!0,e.outOfBoundsKill=!0,e.body.velocity.x=this.bulletVelocity*this.game.time.slowMotion,e.body.allowGravity=!1,e.scale.setTo(.4),this.playFireSound()}this.resetFireTimer()}},e.prototype.resetFireTimer=function(){this.bulletTimer=this.game.time.time},e.prototype.addAnimations=function(){var t=this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].animations;for(var e in t)this.sprite.animations.add(e,t[e].frames,t[e].frameRate,t[e].loop,t[e].useNumericIndex);this.sprite.events.onAnimationComplete.add(function(){this.isAlive&&(this.sprite.animations.stop(),this.idleCallback())},this)},e.prototype.initBullets=function(){this.bullets=this.game.add.group(),this.bullets.enableBody=!0,this.firePower=this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].firePower,this.bullets.createMultiple(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.qty,this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.key,this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.frame),this.rockets=this.game.add.group(),this.rockets.enableBody=!0,this.rockets.createMultiple(4,"bullets","bullet2")},e.prototype.updateFuel=function(){var t=this.game.time.elapsedSecondsSince(this.fuelTimer);t>.02&&(this.fuelTimer=this.game.time.time,this.sprite.body.touching.down?this.fuel<this.maxFuel&&(this.fuel+=1):this.fuel>5?this.fuel-=5:this.fuel=0)},e.prototype.unShield=function(){"hero1"==this.sprite.key&&this.sprite.removeChildAt(this.shield)},e.prototype.update=function(){},e.prototype.setBulletVelocity=function(t){this.bulletVelocity=t*this.facing},e.prototype.collideWithGroup=function(t){this.game.physics.arcade.collide(t,this.sprite,null,null,this)},e.prototype.collectsGroup=function(t){this.game.physics.arcade.collide(t,this.sprite,this.collect,null,this)},e.prototype.collideWithObject=function(t){this.game.physics.arcade.collide(t,this.sprite,null,null,this)},e.prototype.diesWithGroup=function(t){this.game.physics.arcade.overlap(t,this.sprite,this.die,null,this)},e.prototype.diesWithObject=function(t){this.game.physics.arcade.overlap(t,this.sprite,this.die,null,this)},e.prototype.die=function(t,e){if(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].isImmortal)return!1;var i=this.game.time.elapsedSince(this.dieTimer);return i<this.respawnDelay?!1:(this.dieTimer=this.game.time.time,this.playGetHitSound(),e&&("blueBeam"!=e.frameName&&e.kill(),this.checkRocketCollision(e)),"hero1"==this.sprite.key&&(this.comboLevel>0&&this.game.state.states.Level1.ui.infoText.showComboText("Combo Lost!"),this.comboLevel=0),this.shield>0?(this.shield-=1,this.flickerSprite(16711680),this.unShield(),this.onHit.dispatch(),!1):this.lives>1?(this.lives-=1,this.onHit.dispatch(),this.dieReset(),!1):(this.lives-=1,t.alive=!1,this.deadSince=this.game.time.time,this.updateComboByEnemy(),this.bullets&&this.bullets.forEachAlive(function(t){t.kill()},this),this.rockets&&this.rockets.forEachAlive(function(t){t.kill()},this),t.animations.play("takehit",4,!1,!0),!0))},e.prototype.dieReset=function(){this.sprite.reset(100,this.game.world.centerY);var e=Math.floor(this.respawnDelay/550);t.Utils.interval(this.flickerSprite.bind(this),400,e),this.firePower=1},e.prototype.updateComboByEnemy=function(){if("Intro"!=sh.state.getCurrentState().key&&"smallMissileEnemy"!=this.sprite.key&&"hero1"!=this.sprite.key){var t=this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].shields;0==t&&(t=1),this.game.state.states.Level1.hero.updateCombo(t/10),this.game.state.states.Level1.ui.scoreUp(50*t)}},e.prototype.flickerSprite=function(t){void 0===t&&(t=16711680),this.sprite.tint=t,this.game.time.events.add(150,function(){this.sprite.tint=16777215},this)},e.prototype.collect=function(t,e){e.collect(this),e.kill()},e.prototype.createNewBullet=function(t,e){var i,s;return t&&e?(i=t,s=e):(i=this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.key,s=this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.frame),this.bullets.create(-200,-200,i,s)},e.prototype.checkRocketCollision=function(t){this.shield>0&&"bullet2"==t.frameName&&(this.shield=0)},e.prototype.setRespawnDelay=function(t){this.respawnDelay=t},e.prototype.canRespawn=function(){var t=this.game.time.elapsedSince(this.deadSince);return t>this.respawnDelay?!0:!1},e.prototype.renderShield=function(){var t=["shield1","shield2","shield3"],e=this.game.add.sprite(20,95,"shields",t[this.shield-1]);this.game.physics.arcade.enable(e),e.scale.setTo(2.5,2.5),e.anchor.setTo(.5,.5),e.rotation+=Phaser.Math.degToRad(90),this.sprite.addChild(e)},e.prototype.setIdleCallback=function(t,e){void 0===e&&(e=this),this.idleCallback=t.bind(e)},e.prototype.playGetHitSound=function(){this.soundEnabled=this.game.conf.ISMUSICENABLED,this.soundEnabled&&this.hitSound.play()},e.prototype.playFireSound=function(){this.soundEnabled=this.game.conf.ISMUSICENABLED,this.soundEnabled&&this.fireSound.play()},e}());t.Character=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(t){function e(e,i){var s;s=i?i:"hero1",t.call(this,e,s,e.world.centerX-200,e.world.centerY),this.facing=1,this.shootDelay=500,this.timewarpActive=!1,this.setBulletVelocity(1e3)}return __extends(e,t),e.prototype.update=function(){t.prototype.update.call(this);var e=this._state.update();e!==this._state&&(this._state.exitState(),e.enterState(),this._state=e)},e.prototype.updateCombo=function(t){var e=this.comboLevel;this.comboLevel+=t,this.game.state.states.Level1.ui.scoreUp(50),Math.floor(this.comboLevel)>Math.floor(e)&&this.game.state.states.Level1.ui.infoText.showComboText(this.comboLevel)},e.prototype.fireWarp=function(){this.timeWarps<=0||!this.sprite.alive||(this.timewarpActive=!0,this.game.add.tween(this.game.time).to({slowMotion:5},300,Phaser.Easing.Linear.None,!0,0,0,!1).onComplete.add(function(){this.sprite.body.drag.x*=3*this.game.time.slowMotion,this.sprite.body.drag.y*=3*this.game.time.slowMotion},this),this.game.conf.ISMUSICENABLED&&this.game.add.tween(this.game.state.states.Level1.theme).to({volume:.05},300,Phaser.Easing.Linear.None,!0,0,0,!1),this.game.time.events.add(8e3,function(){this.sprite.body.drag.x/=3*this.game.time.slowMotion,this.sprite.body.drag.y/=3*this.game.time.slowMotion,this.game.add.tween(this.game.time).to({slowMotion:1},1e3,Phaser.Easing.Linear.None,!0,0,0,!1),this.game.conf.ISMUSICENABLED&&this.game.add.tween(this.game.state.states.Level1.theme).to({volume:.5},1e3,Phaser.Easing.Linear.None,!0,0,0,!1)},this),this.game.time.events.add(6e3,function(){this.fxEnabled&&this.warpEnd.play(),this.game.time.events.add(2e3,function(){this.timewarpActive=!1},this)},this),this.timeWarps-=1,this.fxEnabled&&this.fireWarpSound.play())},e.prototype.fireRocket=function(){if(!(this.bombs<=0)&&this.canShoot()){this.sprite.animations.play("shoot");var t=this.rockets.getFirstDead();t||(t=this.rockets.create(-10,-10,"bullets","bullet2")),t.anchor.setTo(.5,1),t.reset(this.sprite.x+40*this.facing,this.sprite.y+this.sprite.height/2),t.checkWorldBounds=!0,t.outOfBoundsKill=!0,t.body.velocity.x=this.bulletVelocity,t.body.allowGravity=!1,t.scale.setTo(.6),this.bulletTimer=this.game.time.time,this.bombs-=1,this.fxEnabled&&this.fireRocketSound.play()}},e.prototype.fireNuke=function(){if(!(this.nukes<=0)&&this.sprite.alive){var t=this.game.add.graphics(0,0);t.lineStyle(0),t.beginFill(16777215,1);var e=t.drawRect(0,0,this.game.width,this.game.height),i=this.game.add.tween(e);i.to({alpha:0},1500),i.onComplete.add(function(){t.destroy()},this),i.start(),this.game.state.states.Level1.obstacleManager.killAll(),this.game.state.states.Level1.enemyManager.killAll(),this.bulletTimer=this.game.time.time,this.nukes-=1,this.fxEnabled&&this.fireNukeSound.play()}},e.prototype.die=function(e,i){var s=t.prototype.die.call(this,e,i);if(s||(this.fxEnabled=this.game.conf.ISMUSICENABLED,this.fxEnabled&&this.takeHitSound.play()),s){{var o=this.game.add.audio("heroDie",.8,!1);this.game.state.getCurrentState()}o.play()}return s},e.prototype.initAudio=function(){this.hitSound=this.game.add.audio("enemyHit",.5,!1),this.fireSound=this.game.add.audio(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].fireSound,this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].fireVolume,!1),this.fireNukeSound=this.game.add.audio("heroFireNuke",.9),this.fireWarpSound=this.game.add.audio("heroFireWarp",.8),this.fireRocketSound=this.game.add.audio("heroFireRocket",.2),this.warpEnd=this.game.add.audio("heroWarpEnd",.8),this.takeHitSound=this.game.add.audio("heroGetHit",.8)},e}(t.Character);t.Hero=e}(Superhero||(Superhero={}));var Superhero;!function(t){!function(t){t[t.TOP=150]="TOP",t[t.DOWN=-150]="DOWN"}(t.spawnEnemyPosition||(t.spawnEnemyPosition={}));var e=(t.spawnEnemyPosition,function(e){function i(t,i){e.call(this,t,i.assetsKey,t.width-i.spawnLocation.x,i.spawnLocation.y),this.isPatrolling=!1,this.fireEnabled=!0,this.dropsSmoke=!1,this.setCustomEnemyProperties(i),this.lives=1}return __extends(i,e),i.prototype.update=function(){e.prototype.update.call(this);var t=this._state.update();t!==this._state&&(this._state.exitState(),t.enterState(),this._state=t)},i.prototype.setCustomEnemyProperties=function(e){this.firePower=e.firePower,this.spawnPoint=e.spawnPoint,this.facing=e.facing,this.setBulletVelocity(e.bulletVelocity),this.shootDelay=e.shootDelay,this.deadSince=e.deadSince,this.fireEnabled=e.fireEnabled,this.shield=e.shields,this.sprite.rotation=0,e.respawnDelay&&(this.respawnDelay=e.respawnDelay),this.dropsSmoke=e.dropsSmoke,this.soundEnabled=e.soundEnabled,this.resetFireTimer(),this._state=new t.StateEnemyHostile(this.game,this),1==e.defaultState&&(this.isPatrolling=!0,this._state.patrol(e.spawnPoint)),"smallMissileEnemy"==e.assetsKey&&this._state.startWarning(),this.dropsSmoke&&this.initSmokeEmitter(),this.sprite.animations.play(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].idleAnimation)},i.prototype.initPhysics=function(){e.prototype.initPhysics.call(this),this.sprite.body.drag.x=0,this.sprite.body.collideWorldBounds=!1,this.sprite.body.checkWorldBounds=!0},i.prototype.fire=function(){if(this.fireEnabled&&this.canShoot()){var t=this.game.time.elapsedSince(this.bulletTimer);if(t<this.shootDelay)return;this.sprite.animations.play("shoot",this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].shootAnimationFrames);for(var e=0;e<this.firePower;e++){var i=this.bullets.getFirstDead();i||(i=this.createNewBullet()),i.anchor.setTo(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.anchor.x,this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.anchor.y),this.playFireSound(),i.reset(this.sprite.x+40*this.facing,this.sprite.y+(10*e+1)),i.angle=180,i.checkWorldBounds=!0,i.outOfBoundsKill=!0,i.body.velocity.x=this.bulletVelocity,i.body.allowGravity=this.allowGravity,i.scale.setTo(this.game.conf.WORLD.sprite_scaling)}this.bulletTimer=this.game.time.time}},i.prototype.initSmokeEmitter=function(){this.smokeEmitter=this.game.add.emitter(),this.smokeEmitter.maxParticles=13,this.sprite.addChild(this.smokeEmitter),this.smokeEmitter.makeParticles("smoke"),this.smokeEmitter.setXSpeed(0,-50),this.smokeEmitter.setYSpeed(0,0),this.smokeEmitter.setRotation(0,0),this.smokeEmitter.setAlpha(.1,1,3e3),this.smokeEmitter.setScale(.8,1.5,.8,1.5,1e3,Phaser.Easing.Quintic.Out),this.smokeEmitter.gravity=-30,this.smokeEmitter.y=45,this.smokeEmitter.x=36},i.prototype.startSmokeEmitter=function(){this.smokeEmitter.start(!1,2e3,100),this.smokeEmitter.on=!0},i.prototype.stopSmokeEmitter=function(){this.smokeEmitter.on=!1},i}(t.Character));t.EnemyBase=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(){function e(t,e){this.multiplier=0,this.game=t,this.currentLevel=e,this.startTimer(),this.enemies=[],this.enemiesAlive=[],this.createLevelEnemies()}return e.prototype.killAll=function(){for(var t=0;t<this.enemiesAlive.length;t++)this.enemiesAlive[t].shield=0,this.enemiesAlive[t].die(this.enemiesAlive[t].sprite)},e.prototype.startTimer=function(){this.enemiesTimer=this.game.time.create(!1),this.enemiesTimer.start(),this.enemiesTimer.loop(this.game.conf.ENEMIES.respawnLapse,this.updateMultiplier,this)},e.prototype.updateMultiplier=function(){this.multiplier+=this.game.conf.ENEMIES.multiplier,this.tryToSpawnEnemy()},e.prototype.spawnRandomEnemy=function(){var t=this.getRandomEnemySpawnPosition(!0),e=this.getRandomEnemyState(),i=this.getRandomEnemyAsset();"tentabot01"===i?e=0:"miniBoss"==i?(e=1,t=-150):"smallMissileEnemy"==i&&(e=0);var s={assetsKey:i,facing:-1,bulletVelocity:this.getBulletSpeed(),spawnLocation:this.getSpawnCoordinates(e,t),firePower:this.getFirePower(i),shootDelay:this.getShootDelay(i),defaultState:e,spawnPoint:t,fireEnabled:!0,shields:this.game.conf.CHARACTERSCOLLECTION[i].shields,respawnDelay:1e3,soundEnabled:!0,dropsSmoke:this.game.conf.CHARACTERSCOLLECTION[i].dropsSmoke};"tentabot01"===i&&(s.spawnLocation.y-=150==s.spawnPoint?100:25);var o=this.getFirstEnemyDead(s.assetsKey);o&&(s.spawnLocation.x=this.game.width-s.spawnLocation.x,o._state.stopPatrol(),o.sprite.alive||(o.sprite.reset(s.spawnLocation.x,s.spawnLocation.y),o.setCustomEnemyProperties(s),this.enemiesAlive.push(o)))},e.prototype.getFirstEnemyDead=function(t){for(var e=0;e<this.enemies.length;e++)if(this.enemies[e].sprite.key===t&&!this.enemies[e].sprite.alive&&this.enemies[e].canRespawn())return this.enemies[e];return null},e.prototype.getShootDelay=function(t){var e=this.game.conf.ENEMIES.shootDelay/(1+this.multiplier);return this.game.conf.CHARACTERSCOLLECTION[t].minShootDelay>e&&(e=this.game.conf.CHARACTERSCOLLECTION[t].minShootDelay),e},e.prototype.getBulletSpeed=function(){var t=this.game.conf.ENEMIES.bulletSpeed*(1+this.multiplier);return t>this.game.conf.ENEMIES.maxBulletSpeed&&(t=this.game.conf.ENEMIES.maxBulletSpeed),t},e.prototype.getRandomEnemyAsset=function(){var t=this.game.rnd.integerInRange(0,this.enemiesAvailableToRespawn.length-1);return this.enemiesAvailableToRespawn[t]},e.prototype.getFirePower=function(t){return this.game.conf.CHARACTERSCOLLECTION[t].firePower},e.prototype.getSpawnCoordinates=function(t,e){var i;return i=1===t?150===e?{x:this.game.conf.ENEMIES.spawnCoordinates.patrol.top.x,y:20}:{x:this.game.conf.ENEMIES.spawnCoordinates.patrol.down.x,y:this.game.height-70}:150===e?{x:this.game.conf.ENEMIES.spawnCoordinates.steady.top.x,y:this.game.height/3}:{x:this.game.conf.ENEMIES.spawnCoordinates.steady.down.x,y:this.game.height/3*2}},e.prototype.getRandomEnemyState=function(){return this.game.rnd.integerInRange(0,1)},e.prototype.getRandomEnemySpawnPosition=function(t){var e,i;if(i=t?this.enemiesAlive:this.enemies,0==i.length){var s=this.game.rnd.integerInRange(0,1);e=0==s?150:-150}else e=150==i[0].spawnPoint?-150:150;return e},e.prototype.createLevelEnemies=function(){var t=this;this.enemiesForThisLevel=this.game.conf.ENEMIES.levels[this.currentLevel],this.enemiesAvailableToRespawn=[],this.enemiesAvailableToRespawnTimer=this.game.time.create(!0),this.enemiesForThisLevel.forEach(function(e){var i=t.getInitDefaultEnemyProperties(e);t.enemiesAvailableToRespawnTimer.add(t.game.conf.CHARACTERSCOLLECTION[e].availableSince,t.appendEnemyAvailalbeToRespawn,t,e);for(var s=0;2>s;s++){var o=t.spawnEnemy(i);o.sprite.kill(),o.sprite.events.onKilled.add(function(t){this.enemiesTimer.stop(),this.enemiesTimer.start();for(var e=0;e<this.enemiesAlive.length;e++)if(this.enemiesAlive[e].sprite===t){var i=this.enemiesAlive.indexOf(this.enemiesAlive[e],0);void 0!=i&&this.enemiesAlive.splice(i,1)}this.enemiesTimer.loop(this.game.conf.ENEMIES.respawnLapse,this.updateMultiplier,this)},t),t.enemies.push(o)}}),this.enemiesAvailableToRespawnTimer.start()},e.prototype.appendEnemyAvailalbeToRespawn=function(t){this.enemiesAvailableToRespawn.push(t)},e.prototype.spawnEnemy=function(e){return"tentabot01"===e.assetsKey?new t.TentacleBot(this.game,e):"twoHandedWeapon"===e.assetsKey?new t.TwoHandedEnemy(this.game,e):"miniBoss"===e.assetsKey?new t.MiniBoss(this.game,e):"smallMissileEnemy"===e.assetsKey?new t.SmallMissileEnemy(this.game,e):new t.EnemyBase(this.game,e)
},e.prototype.getInitDefaultEnemyProperties=function(t){var e={assetsKey:t,facing:-1,bulletVelocity:this.game.conf.ENEMIES.bulletSpeed,spawnLocation:{x:this.game.width-200,y:this.game.height-200},firePower:this.getFirePower(t),shootDelay:this.game.conf.ENEMIES.shootDelay,defaultState:0,spawnPoint:this.getRandomEnemySpawnPosition(!1),deadSince:this.game.time.time,soundEnabled:!1,dropsSmoke:!1};return e},e.prototype.update=function(){this.enemies.forEach(function(t){return t.update()})},e.prototype.tryToSpawnEnemy=function(){"level1"==this.currentLevel&&this.totalEnemiesAlive()<2&&this.spawnRandomEnemy()},e.prototype.totalEnemiesAlive=function(){return this.enemiesAlive.length},e.prototype.spawnCustomEnemy=function(t){var e=0,i=150,s={assetsKey:t,facing:-1,bulletVelocity:this.getBulletSpeed(),spawnLocation:this.getSpawnCoordinates(e,i),firePower:this.getFirePower(t),shootDelay:this.getShootDelay(t),defaultState:e,spawnPoint:i,fireEnabled:!1,shields:this.game.conf.CHARACTERSCOLLECTION[t].shields,respawnDelay:1e3,soundEnabled:!0,dropsSmoke:this.game.conf.CHARACTERSCOLLECTION[t].dropsSmoke},o=this.getFirstEnemyDead(s.assetsKey);o&&(s.spawnLocation.x=this.game.width-s.spawnLocation.x,"twoHandedWeapon"==t&&(s.spawnLocation.y=this.game.height-250),o.sprite.alive||(o.sprite.reset(s.spawnLocation.x,s.spawnLocation.y),o.setCustomEnemyProperties(s),this.enemiesAlive.push(o)))},e}();t.EnemyManager=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(t){function e(e,i){t.call(this,e,i),this.missilesLaunched=!1,this.missiles=[],this.addAnimations(),this.initMisslesPhysics(),this.initTimer()}return __extends(e,t),e.prototype.initTimer=function(){this.missilesTimer=this.game.time.create(!1),this.missilesTimer.stop(),this.missilesTimer.start()},e.prototype.initMisslesPhysics=function(){for(var t=0;4>t;t++)this.missiles.push(this.bullets.create(-50,-50,this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.key,this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bullets.frame)),this.game.physics.enable(this.missiles[t],Phaser.Physics.ARCADE)},e.prototype.addAnimations=function(){t.prototype.addAnimations.call(this),this.sprite.animations.play(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].idleAnimation)},e.prototype.fire=function(){if((this.missilesTimer.seconds>10||this.missilesTimer.seconds<0)&&this.initTimer(),this.missilesLaunched&&this.missilesTimer.seconds>4)for(var t=0;4>t;t++){var e=this.missiles[t];this.resetMisslesTexture("withFire"),e.body.velocity.x-=35,e.body.velocity.y-=3}if("shoot"!=this.sprite.animations.currentAnim.name||this.sprite.animations.currentAnim.isFinished)if(this.missilesTimer.seconds>3&&this.missilesTimer.seconds<3.4){if(this.sprite.animations.play("fire"),!this.missilesLaunched){for(var t=0;4>t;t++)this.missiles[t].body.gravity.y=66,this.missiles[t].reset(this.sprite.x+this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].missiles[t].x,this.sprite.y+this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].missiles[t].y);this.missilesLaunched=!0,this.playFireSound()}}else this.missilesTimer.seconds>5&&(this.missilesLaunched=!1,this.bulletTimer=this.game.time.time,this.missilesTimer.stop(),this.missilesTimer.start(),this.resetMisslesTexture("withoutFire")),this.sprite.animations.play(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].idleAnimation)},e.prototype.resetMisslesTexture=function(t){var e=this;this.missiles.forEach(function(i){return i.loadTexture(e.sprite.key,t)})},e}(t.EnemyBase);t.TentacleBot=e}(Superhero||(Superhero={}));var Superhero;!function(t){!function(t){t[t.STRAIGHT=0]="STRAIGHT",t[t.UP=1]="UP",t[t.DOWN=2]="DOWN"}(t.BulletDirection||(t.BulletDirection={}));var e=(t.BulletDirection,function(t){function e(e,i){t.call(this,e,i),this.addAnimations(),this.initBullets(),this.dieSound=this.game.add.audio("twoHandedDie",.4,!1)}return __extends(e,t),e.prototype.initBullets=function(){this.bullets=this.game.add.group(),this.bullets.enableBody=!0,this.bullets.createMultiple(2,"twoHandedWeapon","downProjectile"),this.bullets.createMultiple(2,"twoHandedWeapon","upperProjectile"),this.bullets.createMultiple(2,"twoHandedWeapon","mainProjectile")},e.prototype.addAnimations=function(){t.prototype.addAnimations.call(this),this.sprite.animations.play(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].idleAnimation)},e.prototype.fire=function(){if(this.sprite.alive&&this.fireEnabled&&("shootRightWhenDown"!=this.sprite.animations.currentAnim.name||"shootRightWhenUp"!=this.sprite.animations.currentAnim.name||"shootLeft"!=this.sprite.animations.currentAnim.name||this.sprite.animations.currentAnim.isFinished)&&"takehit"!=this.sprite.animations.currentAnim.name){if(!this.shootTimeUp())return;this.lastFireLeft?(this.lastFireLeft=!1,150==this.spawnPoint?(this.sprite.animations.play("shootRightWhenUp"),this.game.time.events.add(250,function(){this.fireBullet("downProjectile",2)},this)):(this.sprite.animations.play("shootRightWhenDown"),this.game.time.events.add(250,function(){this.fireBullet("upperProjectile",1)},this))):(this.lastFireLeft=!0,this.sprite.animations.play("shootLeft"),setTimeout(function(){this.fireBullet("mainProjectile",0)}.bind(this),250)),this.bulletTimer=this.game.time.time}},e.prototype.fireBullet=function(t,e){var i=this.getCustomBullet(t);i||(i=this.createNewBullet("twoHandedWeapon",t)),this.playFireSound(),i.reset(this.sprite.x+40*this.facing,this.sprite.y+15),0!=e&&(i.body.velocity.y=2==e?100:-100),i.checkWorldBounds=!0,i.outOfBoundsKill=!0,i.body.velocity.x=this.bulletVelocity,i.body.allowGravity=this.allowGravity,i.scale.setTo(this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].bulletScale)},e.prototype.getCustomBullet=function(t){for(var e=0;e<this.bullets.length;e++)if(this.bullets.children[e].frameName===t&&!this.bullets.children[e].alive)return this.bullets.children[e];return null},e.prototype.die=function(t,e){if(!this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].isImmortal){var i=this.game.time.elapsedSince(this.dieTimer);if(!(i<this.respawnDelay))return this.dieTimer=this.game.time.time,this.game.conf.ISMUSICENABLED&&this.playGetHitSound(),e&&this.checkRocketCollision(e),this.shield>0?(this.smokeEmitter.on||this.startSmokeEmitter(),this.shield-=1,this.flickerSprite(16711680),!1):(this.smokeEmitter.on&&this.stopSmokeEmitter(),this.updateComboByEnemy(),this.sprite.body.checkWorldBounds=!0,this.sprite.body.outOfBoundsKill=!0,this.game.conf.ISMUSICENABLED&&this.dieSound.play(),this.sprite.body.angularVelocity=this.game.rnd.integerInRange(-400,-300),this.bullets&&this.bullets.forEachAlive(function(t){t.kill()},this),this.game.physics.arcade.accelerationFromRotation(this.sprite.rotation,this.game.rnd.integerInRange(-300,-400),this.sprite.body.acceleration),this.deadSince=this.game.time.time,!0)}},e}(t.EnemyBase));t.TwoHandedEnemy=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(t){function e(e,i){t.call(this,e,i),this.addAnimations()}return __extends(e,t),e.prototype.addAnimations=function(){t.prototype.addAnimations.call(this),this.sprite.animations.play("flystill")},e.prototype.fire=function(){if(this.sprite.alive&&this.fireEnabled&&("shoot"!=this.sprite.animations.currentAnim.name||this.sprite.animations.currentAnim.isFinished)){if(!this.shootTimeUp())return;this._state.pausePatrol(),this.sprite.animations.play("shoot",this.game.conf.CHARACTERSCOLLECTION[this.sprite.key].shootAnimationFrames),this.game.time.events.add(1e3,function(){this.fireBullet()},this)}},e.prototype.fireBullet=function(){if(this.sprite.alive){for(var t=this.sprite.x-this.sprite.width*this.sprite.anchor.x,e=0,i=0;e<this.game.width;i++){var s=this.getCustomBullet("blueBeam");s||(s=this.createNewBullet()),s.alpha=1,s.anchor.setTo(1,0),s.reset(t,this.sprite.y),this.playFireSound(),s.checkWorldBounds=!0,s.outOfBoundsKill=!0,s.body.velocity.x=0,t-=s.width,this.game.add.tween(s).to({alpha:0},600,Phaser.Easing.Bounce.In,!0,0,0,!1).onComplete.add(function(t){t.kill()},this),e+=s.width}this._state.resumePatrol(),this.resetFireTimer()}},e.prototype.getCustomBullet=function(t){for(var e=0;e<this.bullets.length;e++)if(this.bullets.children[e].frameName===t&&!this.bullets.children[e].alive)return this.bullets.children[e];return null},e.prototype.die=function(e,i){return this.shield<1&&(this.sprite.body.velocity.x=80,this.bullets&&this.bullets.forEachAlive(function(t){t.kill()},this)),t.prototype.die.call(this,e,i)},e}(t.EnemyBase);t.MiniBoss=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(t){function e(e,i){t.call(this,e,i),this.addAnimations(),this.initPhysics(),this.sprite.events.onKilled.add(function(){this.warningSound.stop(),this.sirenSound.stop(),this.missileSound.stop(),this.die(this.sprite)},this)}return __extends(e,t),e.prototype.addAnimations=function(){t.prototype.addAnimations.call(this),this.sprite.animations.play("flystill")},e.prototype.initAudio=function(){t.prototype.initAudio.call(this),this.warningSound=this.game.add.audio("smallMissileWarningSound",.5,!1),this.sirenSound=this.game.add.audio("smallMissileSiren",.3,!0),this.missileSound=this.game.add.audio("smallMissileMissile",1,!1)},e.prototype.update=function(){t.prototype.update.call(this),this.game.physics.arcade.collide(this.game.state.states.Level1.hero.sprite,this.sprite,this.handleHeroCollition,null,this),this.game.state.states.Level1.obstacleManager.diesWith(this.sprite,this.game.state.states.Level1.killWallEnemy,this.game.state.states.Level1)},e.prototype.handleHeroCollition=function(t,e){this.game.state.states.Level1.hero.die(t,e)},e.prototype.fire=function(){if(this.sprite.alive&&("shoot"!=this.sprite.animations.currentAnim.name||this.sprite.animations.currentAnim.isFinished)){var t=this.game.time.elapsedSince(this.bulletTimer);if(t<this.shootDelay)return;this.sprite.animations.play("shoot"),this._state.engage()}},e}(t.EnemyBase);t.SmallMissileEnemy=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(){function t(t){this.game=t,this.init()}return t.prototype.init=function(){var t={font:"14px Courier",fill:"#ffffff",align:"left"};this.info=this.game.add.text(16,16," ",t),this.info.lineSpacing=4,this.info.setShadow(2,2)},t.prototype.update=function(){var t="";this.game.time.advancedTiming=!0,t=t.concat("FPS: "+(this.game.time.fps.toString()||"--")+"\n"),t=t.concat("Game size: "+this.game.width+" x "+this.game.height+"\n"),t=t.concat("Actual size: "+this.game.scale.width+" x "+this.game.scale.height+"\n"),t=t.concat("minWidth: "+this.game.scale.minWidth+" - minHeight: "+this.game.scale.minHeight+"\n"),t=t.concat("maxWidth: "+this.game.scale.maxWidth+" - maxHeight: "+this.game.scale.maxHeight+"\n"),t=t.concat("aspect ratio: "+this.game.scale.aspectRatio+"\n"),t=t.concat("parent is window: "+this.game.scale.parentIsWindow+"\n"),t=t.concat("bounds x: "+this.game.scale.bounds.x+" y: "+this.game.scale.bounds.y+" width:"+this.game.scale.bounds.width+" height: "+this.game.scale.bounds.height+"\n"),this.info.text=t},t}();t.Debug=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(){function t(){var t=this.getRemote();this.WORLD=JSON.parse(t).WORLD,this.PHYSICS=JSON.parse(t).PHYSICS,this.PLAYERDIEOUTOFBOUNDS=JSON.parse(t).PLAYERDIEOUTOFBOUNDS,this.ENEMIES=JSON.parse(t).ENEMIES,this.PLAYERISIMMORTAL=JSON.parse(t).PLAYERISIMMORTAL,this.ISMUSICENABLED=JSON.parse(t).ISMUSICENABLED,this.CHARACTERSCOLLECTION=JSON.parse(t).CHARACTERSCOLLECTION,this.FIRSTTIMEPLAYING=JSON.parse(t).FIRSTTIMEPLAYING,this.POWERUPS=JSON.parse(t).POWERUPS,this.SCOREBOARD=JSON.parse(t).SCOREBOARD,this.TOPSCORE=JSON.parse(t).TOPSCORE,this.GAMEVERSION=JSON.parse(t).GAMEVERSION}return t.prototype.save=function(){if("Level1"==sh.state.current&&(this.POWERUPS.nukes=sh.state.states.Level1.hero.nukes,this.POWERUPS.rockets=sh.state.states.Level1.hero.bombs,this.POWERUPS.timeWarps=sh.state.states.Level1.hero.timeWarps,!sh.state.states.Level1.hero.sprite.alive)){var t={date:Date.now(),score:sh.state.states.Level1.ui.scoreCount};t.score>this.TOPSCORE&&(this.TOPSCORE=t.score),this.SCOREBOARD.push(t)}localStorage.setItem("superhero.conf",JSON.stringify(this))},t.prototype.getRemote=function(){var t=localStorage.getItem("superhero.conf");return t?t:$.ajax({type:"GET",url:"game/config/config.json",async:!1}).responseText},t}();t.Config=e}(Superhero||(Superhero={}));var Obstacles;!function(t){var e=function(){function t(t){this.gameSpeed=-80,this.game=t,this.group=this.game.add.group(),this.group.enableBody=!0,this.group.physicsBodyType=Phaser.Physics.ARCADE,this.group.classType=n,this.obstacleRespawnTime=800,this.baseRespawn=800,this.timer=this.game.time.time}return t.prototype.resetAndRoll=function(){},t.prototype.collidesWith=function(){},t.prototype.diesWith=function(){},t.prototype.speedUp=function(){},t.prototype.killAll=function(){},t}();t.Obstacle=e;var i=function(t){function e(e){t.call(this,e),this.upperObstacle=new s(e),this.lowerObstacle=new o(e)}return __extends(e,t),e.prototype.resetAndRoll=function(t,e,i){var s=this.game.time.elapsedSince(this.timer);if(!(s<this.obstacleRespawnTime)){this.timer=this.game.time.time;var o=this.game.cache.getFrameByName("meteors","brown5").height,a=this.game.height,n=Math.floor(a/o),h=this.game.rnd.integerInRange(2,n-2),r=h-1,l=n-h-1,i=this.gameSpeed*(1+e);this.upperObstacle.resetAndRoll(l,e,i),this.lowerObstacle.resetAndRoll(r,e,i)}},e.prototype.collidesWith=function(t){this.lowerObstacle.collidesWith(t),this.upperObstacle.collidesWith(t)},e.prototype.diesWith=function(t,e,i){this.lowerObstacle.diesWith(t,e,i),this.upperObstacle.diesWith(t,e,i)},e.prototype.speedUp=function(t,e){this.obstacleRespawnTime=this.baseRespawn/(1+e),this.upperObstacle.speedUp(t,e),this.lowerObstacle.speedUp(t,e)},e.prototype.killAll=function(){this.upperObstacle.killAll(),this.lowerObstacle.killAll()},e}(e);t.WallObstacle=i;var s=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.resetAndRoll=function(t,e,i){for(var s=this.game.cache.getFrameByName("meteors","brown5").height,o=this.game.width,a=Superhero.Utils.orderdList(t),n=["brown5","grey5"],h=n[this.game.rnd.integerInRange(0,1)],r=0;t>r;r++){var l=this.group.getFirstDead(),p=o-1,d=a[r]*s;l?l.reset(p,d):l=this.group.create(p,d,"meteors",h),l.body.velocity.x=i,l.body.immovable=!0,l.outOfBoundsKill=!0}},e.prototype.collidesWith=function(t){this.game.physics.arcade.collide(t,this.group)},e.prototype.diesWith=function(t,e,i){this.game.physics.arcade.overlap(t,this.group,e,null,i)},e.prototype.speedUp=function(t,e){this.group.forEach(function(i){i.alive&&(i.body.velocity.x=t*(1+e))},this)},e.prototype.killAll=function(){this.group.forEach(function(t){t.kill()},this)},e}(e);t.UpperObstacle=s;var o=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.resetAndRoll=function(t,e,i){for(var s=this.game.cache.getFrameByName("meteors","brown5").height,o=this.game.height,a=this.game.width,n=Superhero.Utils.orderdList(t),h=["brown5","grey5"],r=h[this.game.rnd.integerInRange(0,1)],l=0;t>l;l++){var p=this.group.getFirstDead(),d=a-1,u=o-s-n[l]*s;p?p.reset(d,u):p=this.group.create(d,u,"meteors",r),p.body.velocity.x=i,p.body.immovable=!0,p.outOfBoundsKill=!0}},e.prototype.collidesWith=function(t){this.game.physics.arcade.collide(t,this.group)},e.prototype.diesWith=function(t,e,i){this.game.physics.arcade.overlap(t,this.group,e,null,i)},e.prototype.speedUp=function(t,e){this.group.forEach(function(i){i.alive&&(i.body.velocity.x=t*(1+e))},this)},e.prototype.killAll=function(){this.group.forEach(function(t){t.kill()},this)},e}(e);t.LowerObstacle=o;var a=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.resetAndRoll=function(t,e,i){var s=this.game.time.elapsedSince(this.timer);if(!(s<this.obstacleRespawnTime||(this.timer=this.game.time.time,this.group.countLiving()>30))){t=1,i=this.gameSpeed*Math.sqrt(1+e);var o=[],a=[];o=[{key:"brown1",mass:45},{key:"brown2",mass:40},{key:"brown3",mass:35},{key:"brown4",mass:35},{key:"brown5",mass:17},{key:"brown6",mass:15},{key:"brown7",mass:10},{key:"brown8",mass:9},{key:"brown9",mass:3},{key:"brown10",mass:2},{key:"grey1",mass:45},{key:"grey2",mass:40},{key:"grey3",mass:35},{key:"grey4",mass:35},{key:"grey5",mass:17},{key:"grey6",mass:15},{key:"grey7",mass:10},{key:"grey8",mass:9},{key:"grey9",mass:3},{key:"grey10",mass:2}];for(var n=0;t>n;n++)a[n]=o[this.game.rnd.integerInRange(0,o.length-1)];for(var h=this.game.height,r=this.game.width,l=h/t,p=[],n=0;t>n;n++)p[n]=this.game.rnd.integerInRange(n*l,(n+1)*l);for(var d=r-1,n=0;t>n;n++){var u=this.group.getFirstDead();u?u.reset(d,p[n]):(u=this.group.create(d,p[n],"meteors",a[n].key),u.body.immovable=a[n].mass>10,u.checkWorldBounds=!0,u.onOutOfBoundsKill=!0),u.body.velocity.x=i*this.game.rnd.realInRange(1,3),u.anchor.setTo(.5,.5),u.body.angularVelocity=this.game.rnd.integerInRange(-100,100)}this.group.setAll("checkWorldBounds",!0),this.group.setAll("outOfBoundsKill",!0)}},e.prototype.collidesWith=function(t){this.game.physics.arcade.collide(t,this.group)},e.prototype.diesWith=function(t,e,i){this.game.physics.arcade.overlap(t,this.group,e,null,i)},e.prototype.speedUp=function(t,e){this.obstacleRespawnTime<=200||(this.obstacleRespawnTime=this.baseRespawn/(1+e))},e.prototype.killAll=function(){this.group.forEach(function(t){t.kill(),this.game.state.states.Level1.hero.updateCombo(.1)},this)},e}(e);t.MeteoriteShower=a;var n=function(t){function e(e,i,s,o,a){t.call(this,e,i,s,o,a)}return __extends(e,t),e}(Phaser.Sprite);t.ObstacleItem=n}(Obstacles||(Obstacles={}));var Obstacles;!function(t){!function(t){t[t.WALL=0]="WALL",t[t.UPPERWALL=1]="UPPERWALL",t[t.LOWERWALL=2]="LOWERWALL",t[t.METEORITE_SHOWER=3]="METEORITE_SHOWER"}(t.ObstacleType||(t.ObstacleType={}));var e=(t.ObstacleType,function(){function e(t,e){void 0===e&&(e=800),this.multiplier=0,this.game=t,this.obstacleTimer=this.game.time.time,this.multiplierTimer=this.game.time.time,this.gameSpeed=-80,this.fxEnabled=this.game.conf.ISMUSICENABLED,this.obstacles=[],this.enabledObstacles=[],this.setObstaclesEmitter(),this.particlesSound=[];for(var i=1;6>i;i++)this.particlesSound.push(this.game.add.audio("obstacle"+i,1,!1))}return e.prototype.update=function(){if(!(this.obstacles.length<=0)){var t=this.game.time.elapsedSecondsSince(this.multiplierTimer);t>10&&(this.multiplier+=.1,this.multiplierTimer=this.game.time.time,this.speedUp());var e=this.game.rnd.integerInRange(0,this.obstacles.length-1),i=this.obstacles[e];i.resetAndRoll(10,this.multiplier),this.obstacleTimer=this.game.time.time}},e.prototype.speedUp=function(){for(var t=0;t<this.obstacles.length;t++)this.obstacles[t].speedUp(this.gameSpeed,this.multiplier)},e.prototype.collidesWith=function(t){for(var e=0;e<this.obstacles.length;e++)this.obstacles[e].collidesWith(t)},e.prototype.diesWith=function(t,e,i){for(var s=0;s<this.obstacles.length;s++)this.obstacles[s].diesWith(t,e,i)},e.prototype.killAll=function(){for(var t=0;t<this.obstacles.length;t++)this.obstacles[t].killAll()},e.prototype.addObstacleToPool=function(e){switch(e){case 0:this.obstacles.push(new t.WallObstacle(this.game)),this.enabledObstacles.push(0);break;case 1:this.obstacles.push(new t.UpperObstacle(this.game)),this.enabledObstacles.push(1);break;case 2:this.obstacles.push(new t.LowerObstacle(this.game)),this.enabledObstacles.push(2);break;case 3:this.obstacles.push(new t.MeteoriteShower(this.game)),this.enabledObstacles.push(3)}},e.prototype.setObstaclesEmitter=function(){this.obstacleEmitter=this.game.add.emitter(),this.obstacleEmitter.makeParticles("meteors","brown10"),this.obstacleEmitter.gravity=0},e.prototype.particleBurst=function(t){this.obstacleEmitter.x=t.x,this.obstacleEmitter.y=t.y,this.fxEnabled=this.game.conf.ISMUSICENABLED,this.fxEnabled&&this.playPartitceSound(),this.obstacleEmitter.start(!0,2e3,null,4)},e.prototype.playPartitceSound=function(){var t=this.game.rnd.integerInRange(0,4);this.particlesSound[t].play()},e}());t.ObstacleManager=e}(Obstacles||(Obstacles={}));var Collectables;!function(t){!function(t){t[t.IMPROVE_FIRE=0]="IMPROVE_FIRE",t[t.IMPROVE_SHIELD=1]="IMPROVE_SHIELD",t[t.NUKE_BOMB=2]="NUKE_BOMB",t[t.TIME_WARP=3]="TIME_WARP",t[t.COIN=4]="COIN",t[t.DIAMOND=5]="DIAMOND",t[t.IMMUNITY=6]="IMMUNITY",t[t.BOMB=7]="BOMB",t[t.LIVES=8]="LIVES"}(t.CollectableType||(t.CollectableType={}));var e=(t.CollectableType,function(){function e(t){this.game=t,this.collectables=new Phaser.Group(this.game),this.onCollect=new Phaser.Signal}return e.prototype.addCollectable=function(e){switch(e){case 0:var i=new t.ImproveFirePower(this.game);this.collectables.add(i);break;case 1:var i=new t.ImprovedShield(this.game);this.collectables.add(i);break;case 2:var i=new t.NukeBomb(this.game);this.collectables.add(i);break;case 3:var i=new t.TimeWarp(this.game);this.collectables.add(i);break;case 5:var i=new t.Diamond(this.game);this.collectables.add(i);break;case 6:var i=new t.Immunity(this.game);this.collectables.add(i);break;case 7:var i=new t.Bomb(this.game);this.collectables.add(i);break;case 8:var i=new t.Lives(this.game);this.collectables.add(i)}},e.prototype.checkCollectedBy=function(t){this.collectables.forEach(function(t,e){t.alive&&t.overlapWithChar(e)&&this.onCollect.dispatch()},this,!1,t)},e.prototype.spawnCollectable=function(t,e,i){var s=this.game.rnd.integerInRange(0,150),o=[0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,3,3,3,4,4,4,4,4,4,5,5];if(!(s>o.length-1||(i||(i=o[s]),this.collectables.length<1||this.collectables.countLiving()>=1))){var a=this.collectables.getAt(i);a&&(a.alive||(a.spawnAt(t,e),a.playAnimation()))}},e}());t.CollectableManager=e}(Collectables||(Collectables={}));var Superhero;!function(t){var e=function(e){function i(){e.apply(this,arguments),this.levelID="level1"}return __extends(i,e),i.prototype.preload=function(){},i.prototype.create=function(){this.configurePhysics(),this.setBaseStage(),this.configureInput(),this.setActors(),this.startMusic(),this.setEnemyManager(),this.startUI()},i.prototype.startUI=function(){this.ui=new t.UI(this.game,this.hero)},i.prototype.update=function(){this.checkForCollisions(),this.hero.update(),this.enemyManager.update(),this.ui.update(),this.obstacleManager.update(),this.checkPCInput()},i.prototype.configurePhysics=function(){this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.physics.arcade.gravity.y=this.game.conf.PHYSICS.global.gravity.y},i.prototype.setBaseStage=function(){this.paralax1=this.game.add.tileSprite(0,0,1800,600,"starfield"),this.paralax1.autoScroll(-100,0),this.obstacleManager=new Obstacles.ObstacleManager(this.game,800),this.obstacleManager.addObstacleToPool(3),this.initCollectables()},i.prototype.setEnemyManager=function(){this.enemyManager=new t.EnemyManager(this.game,this.levelID)},i.prototype.initCollectables=function(){this.collectableManager=new Collectables.CollectableManager(this.game),this.collectableManager.addCollectable(0),this.collectableManager.addCollectable(1),this.collectableManager.addCollectable(2),this.collectableManager.addCollectable(3),this.collectableManager.addCollectable(7),this.collectableManager.addCollectable(8)},i.prototype.configureInput=function(){this.game.gamepad=new Gamepads.GamePad(this.game,3,10),this.game.gamepad.buttonPad.button1.type=4,this.game.gamepad.buttonPad.button2.type=1,this.game.gamepad.buttonPad.button2.enableCooldown(30),this.game.gamepad.buttonPad.button3.type=1,this.game.gamepad.buttonPad.button3.enableCooldown(10),this.game.gamepad.buttonPad.button4.type=4,this.game.gamepad.stick1.settings.topSpeed=600,this.game.input.keyboard.addKey(Phaser.Keyboard.UP).onDown.add(function(){event.preventDefault()},this),this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN).onDown.add(function(){event.preventDefault()},this),this.game.input.keyboard.addKey(Phaser.Keyboard.LEFT).onDown.add(function(){event.preventDefault()},this),this.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT).onDown.add(function(){event.preventDefault()},this),this.pcFireButton=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.pcNukeButton=this.game.input.keyboard.addKey(Phaser.Keyboard.Z),this.pcWarpButton=this.game.input.keyboard.addKey(Phaser.Keyboard.X),this.pcBombButton=this.game.input.keyboard.addKey(Phaser.Keyboard.C),this.cursors=this.game.input.keyboard.createCursorKeys()},i.prototype.setActors=function(){this.hero=new t.Hero(this.game),this.hero.setRespawnDelay(2e3),this.ui=new t.UI(this.game,this.hero),this.game.gamepad.buttonPad.button1.setOnPressedCallback(this.hero.fire,this.hero),this.game.gamepad.buttonPad.button2.setOnPressedCallback(this.hero.fireNuke,this.hero),this.game.gamepad.buttonPad.button2.customCanTriggerCallback=function(){return this.hero.nukes>0&&this.hero.sprite.alive}.bind(this),this.game.gamepad.buttonPad.button3.setOnPressedCallback(this.hero.fireWarp,this.hero),this.game.gamepad.buttonPad.button3.customCanTriggerCallback=function(){return this.hero.timeWarps>0&&this.hero.sprite.alive}.bind(this),this.game.gamepad.buttonPad.button4.setOnPressedCallback(this.hero.fireRocket,this.hero)},i.prototype.startMusic=function(){this.game.conf.ISMUSICENABLED&&(this.theme&&this.theme.destroy(),this.theme=this.game.add.audio("theme",.5,!0),this.theme.play())},i.prototype.checkPCInput=function(){if(this.pcFireButton.isDown&&this.hero.fire(),this.pcNukeButton.isDown&&this.hero.fireNuke(),this.pcWarpButton.isDown&&this.hero.fireWarp(),this.pcBombButton.isDown&&this.hero.fireRocket(),this.cursors.down.isDown||this.cursors.up.isDown||this.cursors.left.isDown||this.cursors.right.isDown){var t={x:0,y:0};this.cursors.up.isDown&&(t.y=-400),this.cursors.down.isDown&&(t.y=400),this.cursors.left.isDown&&(t.x=-400),this.cursors.right.isDown&&(t.x=400),this.hero.move(t)}},i.prototype.checkForCollisions=function(){var t=this,e=this.enemyManager.enemies;e.forEach(function(e){return t.hero.diesWithGroup(e.bullets)}),this.obstacleManager.collidesWith(this.hero.sprite),this.obstacleManager.diesWith(this.hero.bullets,this.killWall,this),this.obstacleManager.diesWith(this.hero.rockets,this.killWall,this),e.forEach(function(e){e.diesWithGroup(t.hero.bullets),e.diesWithGroup(t.hero.rockets),t.obstacleManager.diesWith(e.bullets,t.killWallEnemy,t)}),this.collectableManager.checkCollectedBy(this.hero)},i.prototype.killWall=function(t,e){if(!("bullet1"==t.frameName&&(t.kill(),e.frameName.indexOf("grey")>-1))){e.kill();var i=this.hero.comboLevel;this.hero.comboLevel+=.1,Math.floor(this.hero.comboLevel)>Math.floor(i)&&this.ui.infoText.showComboText(this.hero.comboLevel),this.collectableManager.spawnCollectable(e.position.x,e.position.y),this.obstacleManager.particleBurst(e),this.ui.scoreUp(50)}},i.prototype.killWallEnemy=function(t,e){e.kill(),this.obstacleManager.particleBurst(e)},i.prototype.render=function(){},i.prototype.shutdown=function(){this.game.world.removeAll()},i}(Phaser.State);t.Level1=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(t){function e(){t.apply(this,arguments),this.showing=1}return __extends(e,t),e.prototype.preload=function(){},e.prototype.create=function(){this.rankingText=[],this.paralax2=this.game.add.tileSprite(0,0,1800,600,"starfield"),this.paralax2.autoScroll(-30,0),this.paralax1=this.game.add.tileSprite(0,0,1800,600,"planets"),this.paralax1.autoScroll(-60,0),this.background=this.game.add.tileSprite(0,0,1200,600,"menuBackground"),this.background.autoScroll(-90,0),this.hero=this.game.add.sprite(200,100,"hero1",this.game.conf.CHARACTERSCOLLECTION.hero1.mainSprite),this.hero.scale.setTo(.7,.7);var t=this.game.conf.CHARACTERSCOLLECTION[this.hero.key].animations;for(var e in t)this.hero.animations.add(e,t[e].frames,t[e].frameRate,t[e].loop,t[e].useNumericIndex);this.mainText=this.game.add.sprite(70,this.game.height-130,"superheroText"),this.mainText.scale.setTo(1.1,1.1),this.verstionText=this.game.add.text(this.world.width-100,this.world.height-25,"Version "+this.game.conf.GAMEVERSION,{font:"9px saranaigamebold",fill:"#d3d3d3",align:"left"}),this.game.device.desktop&&this.showControlsInfo(),this.hero.animations.play("fly"),this.game.input.onDown.add(this.parseMenu,this),this.game.physics.arcade.enable(this.hero),this.menu=this.game.conf.FIRSTTIMEPLAYING?this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"mainMenuStartDisabled"):this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"mainMenu"),this.menu.anchor.setTo(.5,.5),this.ranking=this.game.add.sprite(this.game.world.width+200,this.game.world.centerY,"ranking"),this.ranking.scale.setTo(.4),this.ranking.anchor.setTo(.5,.5);var i=this.world.width-this.world.width/5,s=this.world.height-100,o=this.game.conf.ISMUSICENABLED?"on":"off",a={font:"25px saranaigamebold",fill:"#66C8FF",align:"center"};this.musicOnOffText=this.game.add.text(i-100,s+15,"SOUND",a),this.musicOnOff=this.game.add.sprite(i,s,"onoff",o),this.musicOnOff.inputEnabled=!0,this.musicOnOff.events.onInputDown.add(this.switchMusic,this),this.theme=this.game.add.audio("menuTheme",.5),this.theme.loop=!0,this.startSound=this.game.add.audio("menuStart",1),this.game.conf.ISMUSICENABLED&&this.theme.play(),this.game.input.keyboard.addKey(Phaser.Keyboard.UP).onDown.add(function(){event.preventDefault()},this),this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN).onDown.add(function(){event.preventDefault()},this),this.game.input.keyboard.addKey(Phaser.Keyboard.LEFT).onDown.add(function(){event.preventDefault()},this),this.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT).onDown.add(function(){event.preventDefault()},this)},e.prototype.switchMusic=function(){this.game.conf.ISMUSICENABLED?(this.game.conf.ISMUSICENABLED=!1,this.theme.stop(),this.musicOnOff.frame=1,this.game.conf.save()):(this.game.conf.ISMUSICENABLED=!0,this.theme.play(),this.musicOnOff.frame=0,this.game.conf.save())},e.prototype.parseMenu=function(t){1==this.showing?this.parseMainMenu(t):this.parseRanking(t)},e.prototype.parseMainMenu=function(t){var e=this.game.world.centerX-this.menu.width/2,i=this.game.world.centerX+this.menu.width/2,s=this.game.world.centerY-this.menu.height/2,o=this.game.world.centerY+this.menu.height/2;if(t.x>e&&t.x<i&&t.y>s&&t.y<o){var a=(t.x-e,t.y-s),n=Math.floor(a/4/23)+1;switch(n){case 1:this.game.conf.FIRSTTIMEPLAYING||(this.game.conf.ISMUSICENABLED&&(this.game.sound.stopAll(),this.startSound.play()),this.theme.fadeOut(2e3),this.hero.body.acceleration.x=600,this.game.time.events.add(2e3,function(){this.game.sound.stopAll(),this.game.state.start("Level1",!0,!1)},this));break;case 2:this.game.conf.ISMUSICENABLED&&(this.game.sound.stopAll(),this.startSound.play()),this.theme.fadeOut(2e3),this.hero.body.acceleration.x=600,this.game.time.events.add(2e3,function(){this.game.sound.stopAll(),this.game.state.start("Intro",!0,!1)},this);break;case 3:this.showRanking();break;case 4:}}},e.prototype.showRanking=function(){this.showing=2,this.game.add.tween(this.menu).to({x:-this.menu.x},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1),this.game.add.tween(this.musicOnOff).to({x:-this.world.width+this.musicOnOff.x},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1),this.game.add.tween(this.musicOnOffText).to({x:-this.world.width+this.musicOnOffText.x},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1),this.controlsText&&this.game.add.tween(this.controlsText).to({x:-this.world.width+30},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1),this.game.add.tween(this.ranking).to({x:this.world.centerX},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1).onComplete.addOnce(function(){var t={font:"30px saranaigamebold",fill:"#FDCD08",align:"center"},e=this.game.world.centerX+20,i=111,s=this.game.conf.SCOREBOARD,o=s.length;s.sort(function(t,e){return t.score-e.score});for(var a=1;5>=a&&s[o-a];a++)this.rankingText[a-1]=this.game.add.text(e,i,s[o-a].score.toString(),t),i+=83},this)},e.prototype.showMainMenu=function(){for(var t=0;5>t;t++)this.rankingText[t]&&this.rankingText[t].destroy();this.showing=1;var e=this.world.width-this.world.width/5;this.game.add.tween(this.menu).to({x:-this.menu.x},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1),this.game.add.tween(this.musicOnOff).to({x:e},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1),this.game.add.tween(this.musicOnOffText).to({x:e-100},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1),this.game.add.tween(this.ranking).to({x:this.world.width+200},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1),this.controlsText&&this.game.add.tween(this.controlsText).to({x:30},1e3,Phaser.Easing.Exponential.In,!0,0,0,!1)
},e.prototype.parseRanking=function(t){var e=this.game.world.centerX-this.ranking.width/2,i=this.game.world.centerX+this.ranking.width/2,s=this.game.world.centerY-this.ranking.height/2,o=this.game.world.centerY+this.ranking.height/2;t.x>e&&t.x<i&&t.y>s&&t.y<o||this.showMainMenu()},e.prototype.shutdown=function(){this.game.world.removeAll()},e.prototype.showControlsInfo=function(){var t={font:"15px saranaigamebold",fill:"#FDCD08",align:"center"};this.controlsText=this.game.add.text(30,this.world.height-30,"MOVEMENT : Cursors or Mouse    SPACE : Fire    Z : Nuke Bomb    X : Time Warp    C : Launch Rocket",t)},e}(Phaser.State);t.Menu=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.preload=function(){this.loadHolder=this.add.sprite(this.world.centerX,this.world.centerY,"loadHolder");var t=this.loadHolder.width/2-33,e=23;this.preloadBar=this.add.sprite(this.world.centerX-t,this.world.centerY+e,"loadingBar"),this.preloadBar.anchor.setTo(0,.5),this.loadHolder.anchor.setTo(.5),this.load.setPreloadSprite(this.preloadBar),this.loadAssets()},e.prototype.create=function(){this.game.state.start("Menu",!0,!1)},e.prototype.loadAssets=function(){var t="/games/superhero";this.game.load.atlasJSONHash("hero1",t+"/assets/hero1.png",t+"/assets/hero1.json"),this.game.load.atlasJSONHash("herowalking",t+"/assets/hero1Walking.png",t+"/assets/hero1.json"),this.game.load.atlasJSONHash("badie",t+"/assets/hero3.png",t+"/assets/hero3.json"),this.game.load.atlasJSONHash("pups",t+"/assets/pups.png",t+"/assets/pups.json"),this.game.load.atlasJSONHash("meteors",t+"/assets/meteors.png",t+"/assets/meteors.json"),this.game.load.atlasJSONHash("bullets",t+"/assets/bullets.png",t+"/assets/bullets.json"),this.game.load.atlasJSONHash("steel",t+"/assets/steel.png",t+"/assets/steel.json"),this.game.load.atlasJSONHash("shields",t+"/assets/shields.png",t+"/assets/shields.json"),this.game.load.atlasJSONHash("pupanim",t+"/assets/pupanim.png",t+"/assets/pupanim.json"),this.game.load.atlasJSONHash("onoff",t+"/assets/onoff.png",t+"/assets/onoff.json"),this.game.load.atlasJSONHash("introScene",t+"/assets/introScene.png",t+"/assets/introScene.json"),this.game.load.image("starfield",t+"/assets/starfield.png"),this.game.load.image("spaceShipBackground1",t+"/assets/spaceShip1.png"),this.game.load.image("spaceShipBackground2",t+"/assets/spaceShip2.png"),this.game.load.image("planets",t+"/assets/planets.png"),this.game.load.image("puinfo",t+"/assets/PUInfo.png"),this.game.load.image("pauseBtn",t+"/assets/pauseBtn.png"),this.game.load.image("menuBack",t+"/assets/menuBack.png"),this.game.load.image("menuBackDisabled",t+"/assets/menuBack2.png"),this.game.load.image("mainMenu",t+"/assets/mainMenu.png"),this.game.load.image("mainMenuStartDisabled",t+"/assets/mainMenuStartDisabled.png"),this.game.load.image("ranking",t+"/assets/ranking.png"),this.game.load.image("menuBackground",t+"/assets/menuBackground.png"),this.game.load.image("superheroText",t+"/assets/superheroText.png"),this.game.load.image("skipIntro",t+"/assets/skipIntro.png"),this.game.load.image("tut_pc_jump",t+"/assets/tutorial-02.png"),this.game.load.image("tut_pc_pups",t+"/assets/tutorial-01.png"),this.game.load.image("tut_pc_fire",t+"/assets/tutorial-04.png"),this.game.load.image("tut_pc_move",t+"/assets/tutorial-03.png"),this.game.load.image("tut_touch_move",t+"/assets/tutorial-05.png"),this.game.load.image("tut_touch_jump",t+"/assets/tutorial-06.png"),this.game.load.image("tut_touch_fire",t+"/assets/tutorial-07.png"),this.game.load.image("smoke",t+"/assets/smoke-puff.png"),this.game.load.atlasJSONHash("tentabot01",t+"/assets/tentacleBot.png",t+"/assets/tentacleBot.json"),this.game.load.atlasJSONHash("twoHandedWeapon",t+"/assets/twoHandedWeapon.png",t+"/assets/twoHandedWeapon.json"),this.game.load.atlasJSONHash("miniBoss",t+"/assets/miniBoss.png",t+"/assets/miniBoss.json"),this.game.load.atlasJSONHash("smallMissileEnemy",t+"/assets/smallMissileEnemy.png",t+"/assets/smallMissileEnemy.json"),this.game.load.audio("theme",t+"/assets/sounds/demon_destroyer.ogg"),this.game.load.audio("introTheme",t+"/assets/sounds/intro/introTheme.ogg"),this.game.load.audio("enemyHit",t+"/assets/sounds/enemyHit.ogg"),this.game.load.audio("menuTheme",t+"/assets/sounds/menu.ogg"),this.game.load.audio("heroFire",t+"/assets/sounds/hero/fire.ogg"),this.game.load.audio("heroFireWarp",t+"/assets/sounds/hero/fireWarp.ogg"),this.game.load.audio("heroWarpEnd",t+"/assets/sounds/hero/warpEnd.ogg"),this.game.load.audio("heroFireRocket",t+"/assets/sounds/hero/fireRocket.ogg"),this.game.load.audio("heroFireNuke",t+"/assets/sounds/hero/fireNuke.ogg"),this.game.load.audio("heroWarpMeanwhile",t+"/assets/sounds/hero/duringWarp.ogg"),this.game.load.audio("heroGetHit",t+"/assets/sounds/hero/getHit.ogg"),this.game.load.audio("heroTakeOff",t+"/assets/sounds/hero/introTakeOff.ogg"),this.game.load.audio("heroDie",t+"/assets/sounds/hero/die.ogg"),this.game.load.audio("shieldCollect",t+"/assets/sounds/pups/shield.ogg"),this.game.load.audio("extraLifeCollect",t+"/assets/sounds/pups/extraLife.ogg"),this.game.load.audio("timeWarpCollect",t+"/assets/sounds/pups/timeWarp.ogg"),this.game.load.audio("rocketCollect",t+"/assets/sounds/pups/rocket.ogg"),this.game.load.audio("nukeCollect",t+"/assets/sounds/pups/nuke.ogg"),this.game.load.audio("bulletCollect",t+"/assets/sounds/pups/bullet.ogg"),this.game.load.audio("goodJob",t+"/assets/sounds/pups/goodJob.ogg"),this.game.load.audio("congratulations",t+"/assets/sounds/pups/congratulations.ogg"),this.game.load.audio("greatWork",t+"/assets/sounds/pups/greatWork.ogg"),this.game.load.audio("menuStart",t+"/assets/sounds/pups/alright.ogg"),this.game.load.audio("miniBossFire",t+"/assets/sounds/miniBoss/blast.ogg"),this.game.load.audio("twoHandedFire",t+"/assets/sounds/twoHandedEnemy/twoHandedfire.ogg"),this.game.load.audio("twoHandedDie",t+"/assets/sounds/twoHandedEnemy/die.ogg"),this.game.load.audio("tentaBotFire",t+"/assets/sounds/tentacleBot/fire.ogg"),this.game.load.audio("badieFire",t+"/assets/sounds/badie/badieFire.ogg"),this.game.load.audio("smallMissileWarningSound",t+"/assets/sounds/smallMissileEnemy/warning.ogg"),this.game.load.audio("smallMissileSiren",t+"/assets/sounds/smallMissileEnemy/siren.ogg"),this.game.load.audio("smallMissileMissile",t+"/assets/sounds/smallMissileEnemy/missile.ogg"),this.game.load.audio("obstacle1",t+"/assets/sounds/obstacles/obetacle1.ogg"),this.game.load.audio("obstacle2",t+"/assets/sounds/obstacles/obetacle2.ogg"),this.game.load.audio("obstacle3",t+"/assets/sounds/obstacles/obetacle3.ogg"),this.game.load.audio("obstacle4",t+"/assets/sounds/obstacles/obetacle4.ogg"),this.game.load.audio("obstacle5",t+"/assets/sounds/obstacles/obetacle5.ogg"),Gamepads.GamePad.preloadAssets(this.game,t+"/assets")},e}(Phaser.State);t.Preloader=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.preload=function(){this.load.image("loadHolder","/games/superhero/assets/loading.png"),this.load.image("loadingBar","/games/superhero/assets/loadingBar.png")},e.prototype.create=function(){this.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.scale.pageAlignHorizontally=!0,this.scale.pageAlignVertically=!0,this.game.state.start("Preloader",!0,!1)},e}(Phaser.State);t.Boot=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(e){function i(){e.apply(this,arguments),this.levelID="Intro",this.bootsCollected=!1,this.playerCanInteract=!0}return __extends(i,e),i.prototype.preload=function(){},i.prototype.create=function(){this.fxEnabled=this.game.conf.ISMUSICENABLED,this.musicEnabled=this.game.conf.ISMUSICENABLED,this.configurePhysics(),this.setBaseStage(),this.configureInput(),this.setActors("herowalking"),this.startMusic(),this.setEnemyManager(),this.setIntroScene()},i.prototype.update=function(){this.checkForCollisions(),this.hero.update(),this.enemyManager.update(),this.ui.update(),this.obstacleManager.update(),this.checkPCInput()},i.prototype.configurePhysics=function(){this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.physics.arcade.gravity.y=this.game.conf.PHYSICS.global.gravity.y},i.prototype.setBaseStage=function(){this.paralax1=this.game.add.tileSprite(0,0,1800,600,"starfield"),this.paralax1.autoScroll(-10,0),this.paralax2=this.game.add.tileSprite(0,0,3600,600,"planets"),this.paralax2.autoScroll(-30,0),this.spaceShip1=this.game.add.sprite(0,0,"spaceShipBackground1"),this.spaceShip2=this.game.add.sprite(this.spaceShip1.width,0,"spaceShipBackground2"),this.game.physics.arcade.enable(this.spaceShip1),this.spaceShip1.body.velocity.x=-200,this.game.physics.arcade.enable(this.spaceShip2),this.spaceShip2.body.velocity.x=-200,this.paralax5=this.game.add.tileSprite(0,this.world.height-25,this.world.width,this.world.height-25,"steel","floor_c"),this.paralax5.autoScroll(-200,0),this.game.physics.arcade.enable(this.paralax5),this.paralax5.body.immovable=!0,this.paralax5.physicsType=Phaser.SPRITE,this.obstacleManager=new Obstacles.ObstacleManager(this.game,800),this.initCollectables()},i.prototype.setEnemyManager=function(){this.enemyManager=new t.EnemyManager(this.game,this.levelID)},i.prototype.initCollectables=function(){this.collectableManager=new Collectables.CollectableManager(this.game)},i.prototype.configureInput=function(){this.game.gamepad=new Gamepads.GamePad(this.game,5,10),this.game.gamepad.touchInput.touchType=1,this.game.gamepad.buttonPad.button1.type=4,this.game.gamepad.buttonPad.button2.type=1,this.game.gamepad.buttonPad.button3.type=1,this.game.gamepad.buttonPad.button4.type=4,this.game.input.keyboard.addKey(Phaser.Keyboard.UP).onDown.add(function(){event.preventDefault()},this),this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN).onDown.add(function(){event.preventDefault()},this),this.game.input.keyboard.addKey(Phaser.Keyboard.LEFT).onDown.add(function(){event.preventDefault()},this),this.game.input.keyboard.addKey(Phaser.Keyboard.RIGHT).onDown.add(function(){event.preventDefault()},this),this.pcFireButton=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.pcNukeButton=this.game.input.keyboard.addKey(Phaser.Keyboard.Z),this.pcWarpButton=this.game.input.keyboard.addKey(Phaser.Keyboard.X),this.pcBombButton=this.game.input.keyboard.addKey(Phaser.Keyboard.C),this.cursors=this.game.input.keyboard.createCursorKeys()},i.prototype.setActors=function(e){void 0===e&&(e="hero1"),this.hero=new t.Hero(this.game,e),this.hero.sprite.body.gravity.y=1500,this.hero.sprite.body.drag=0,this.hero.sprite.body.height-=15,this.hero.setIdleCallback(this.hero.run),this.game.gamepad.touchInput.onTouchDownCallback=this.hero.jump.bind(this.hero),this.game.gamepad.buttonPad.button1.setOnPressedCallback(this.hero.fire,this.hero),this.game.gamepad.buttonPad.button2.sprite.alpha=.3,this.game.gamepad.buttonPad.button3.sprite.alpha=.3,this.game.gamepad.buttonPad.button4.sprite.alpha=.3,this.hero._state=new t.StateRun(this.game,this.hero),this.hero._state.enterState(),this.ui=new t.UI(this.game,this.hero),this.skipIntroButton=this.game.add.sprite(this.game.width-162,8,"skipIntro"),this.skipIntroButton.inputEnabled=!0,this.skipIntroButton.events.onInputDown.add(this.finishLevel,this)},i.prototype.setIntroScene=function(){this.game.time.events.add(2*Phaser.Timer.SECOND,this.showTutorial,this)},i.prototype.showTutorial=function(){this.tutorialImages=[],this.paralax5.stopScroll(),this.spaceShip1.body.velocity.x=0,this.spaceShip2.body.velocity.x=0,this.hero.sprite.animations.paused=!0,this.hero._state.isMoving=!1,this.hero.sprite.animations.play("stopWalking"),this.game.device.desktop?this.showDesktopTutorial():this.showTouchTutorial()},i.prototype.startSlideShow=function(){return this.currentTutorialImage&&this.currentTutorialImage.destroy(),this.enemyTextBoxGraphic&&this.enemyTextBoxGraphic.destroy(),this.currentTutorialImage=this.tutorialImages.pop(),this.currentTutorialImage?(this.currentTutorialImage.x=150,this.currentTutorialImage.y=150,this.currentTutorialImage.visible=!0,this.enemyTextBoxGraphic=this.game.add.graphics(0,0),this.enemyTextBoxGraphic.lineStyle(2,14378503,1),this.enemyTextBoxGraphic.beginFill(0,.8),this.enemyTextBoxGraphic.drawRect(120,120,this.currentTutorialImage.width+60,this.currentTutorialImage.height+60),this.enemyTextBoxGraphic.endFill(),this.game.world.bringToTop(this.currentTutorialImage),void this.game.time.events.add(4.5*Phaser.Timer.SECOND,this.startSlideShow,this)):(this.paralax5.autoScroll(-200,0),this.spaceShip1.body.velocity.x=-200,this.spaceShip2.body.velocity.x=-200,this.hero.sprite.animations.paused=!1,this.hero._state.isMoving=!0,this.hero.sprite.play(this.game.conf.CHARACTERSCOLLECTION[this.hero.sprite.key].idleAnimation),this.hero._state.isMoving=!1,void this.game.time.events.add(4.5*Phaser.Timer.SECOND,this.spawnMiniBoss,this))},i.prototype.showDesktopTutorial=function(){var t=this.game.add.sprite(0,0,"tut_pc_jump"),e=this.game.add.sprite(0,0,"tut_pc_pups"),i=this.game.add.sprite(0,0,"tut_pc_fire"),s=this.game.add.sprite(0,0,"tut_pc_move");this.tutorialImages=[s,i,e,t],this.tutorialImages.forEach(function(t){t.visible=!1},this),this.startSlideShow()},i.prototype.showTouchTutorial=function(){var t=this.game.add.sprite(0,0,"tut_touch_move"),e=this.game.add.sprite(0,0,"tut_touch_jump"),i=this.game.add.sprite(0,0,"tut_touch_fire");this.tutorialImages=[i,e,t],this.tutorialImages.forEach(function(t){t.visible=!1},this),this.startSlideShow()},i.prototype.spawnMiniBoss=function(){this.enemyManager.totalEnemiesAlive()<2&&(this.enemyManager.spawnCustomEnemy("miniBoss"),this.spaceShip1.body.velocity.x=0,this.spaceShip2.body.velocity.x=0,this.paralax5.stopScroll(),this.hero.sprite.animations.paused=!0,this.hero._state.isMoving=!1,this.hero.sprite.animations.play("stopWalking"),this.game.time.events.add(1*Phaser.Timer.SECOND,this.displayTextScene1,this))},i.prototype.spawnTwoHandedEnemy=function(){this.enemyManager.totalEnemiesAlive()<2&&this.enemyManager.spawnCustomEnemy("twoHandedWeapon")},i.prototype.displayTextScene1=function(){this.enemyTextBoxGraphic=this.game.add.graphics(0,0),this.enemyTextBoxGraphic.lineStyle(2,255,1),this.enemyTextBoxGraphic.beginFill(0,.8),this.enemyTextBoxGraphic.drawRect(100,10,this.game.world.width-300,200),this.enemyTextBoxGraphic.endFill(),this.enemyFace=this.game.add.sprite(this.game.world.width-270,70,"introScene","enemy1"),this.enemyFace.anchor.setTo(.5,0),this.enemyFace.scale.setTo(.5),this.enemyFace.animations.add("introScene",["enemy1","enemy2","enemy3","enemy4","enemy3","enemy2"],60,!0,!1),this.enemyFace.animations.play("introScene",4,!0,!1);var t={font:"30px saranaigamebold",fill:"#ffffff",align:"left",wordWrap:!0,wordWrapWidth:650};this.enemyText=this.game.add.text(410,100,"You shall not pass :P",t),this.playerCanInteract=!0,this.game.time.events.add(5*Phaser.Timer.SECOND,this.displayTextScene2,this)},i.prototype.displayTextScene2=function(){this.heroTextBoxGraphic=this.game.add.graphics(0,0),this.heroTextBoxGraphic.lineStyle(2,255,1),this.heroTextBoxGraphic.beginFill(0,.8),this.heroTextBoxGraphic.drawRect(40,250,this.game.world.width-300,200),this.heroTextBoxGraphic.endFill(),this.heroFace=this.game.add.sprite(100,300,"introScene","hero1"),this.heroFace.anchor.setTo(.5,0),this.heroFace.scale.setTo(.5),this.heroFace.animations.add("introScene",["hero1","hero2","hero3","hero4","hero3","hero2"],60,!0,!1),this.heroFace.animations.play("introScene",10,!0,!1);var t={font:"30px saranaigamebold",fill:"#ffffff",align:"left",wordWrap:!0,wordWrapWidth:650};this.enemyText.setText(""),this.heroText=this.game.add.text(220,330,"Watch N See",t),this.game.time.events.add(5*Phaser.Timer.SECOND,this.displayTextScene3,this)},i.prototype.displayTextScene3=function(){this.heroText.setText(""),this.enemyText.x=220,this.enemyText.y-=20,this.enemyText.setText("Why don't you talk with my friend here..."),this.game.time.events.add(5*Phaser.Timer.SECOND,this.displayTextScene4,this)},i.prototype.displayTextScene4=function(){this.heroText.setText(""),this.enemyText.y+=20,this.enemyText.setText("I'm pretty sure that you'll solve the issue... Bye"),this.spawnTwoHandedEnemy(),this.enemyManager.enemiesAlive[1].shield=20,this.game.time.events.add(5*Phaser.Timer.SECOND,this.displayTextScene5,this)},i.prototype.displayTextScene5=function(){this.enemyManager.enemiesAlive[0].shield=0,this.enemyManager.enemiesAlive[0].die(this.enemyManager.enemiesAlive[0].sprite),this.enemyText.destroy(),this.heroText.setText("So, you seem to be a nice guy..."),this.enemyTextBoxGraphic.destroy(),this.enemyFace.kill(),this.game.time.events.add(5*Phaser.Timer.SECOND,this.displayTextScene6,this)},i.prototype.displayTextScene6=function(){this.heroText.destroy(),this.heroTextBoxGraphic.destroy(),this.heroFace.kill(),this.enemyManager.enemiesAlive[0].fireEnabled=!0,this.enemyManager.enemiesAlive[0]._state.patrol(-150),this.enemyManager.enemiesAlive[0].shield=3,this.enemyManager.enemiesAlive[0].sprite.events.onKilled.add(function(){this.generateBoots()},this)},i.prototype.generateBoots=function(){this.playerCanInteract=!1,this.hero._state.isMoving=!0,this.hero.sprite.animations.paused=!1,this.hero.sprite.play(this.game.conf.CHARACTERSCOLLECTION[this.hero.sprite.key].idleAnimation),this.spaceShip1.body.velocity.x=-200,this.spaceShip2.body.velocity.x=-200,this.paralax5.autoScroll(-200,0),this.bootsCollected=!1,this.boots=this.game.add.sprite(this.game.world.width,this.game.world.height-85,"introScene","boots1"),this.boots.anchor.setTo(.5,0),this.boots.scale.setTo(.7),this.boots.animations.add("introScene",["boots1","boots2","boots3","boots2"],60,!0,!1),this.boots.animations.add("introCollected",["noBoots"],6,!0,!1),this.boots.animations.play("introScene",10,!0,!1),this.game.physics.arcade.enable(this.boots),this.boots.body.enable=!0,this.boots.body.velocity.x=-200,this.game.gamepad.touchInput.inputDisable(),this.game.gamepad.buttonPad.button1.sprite.inputEnabled=!1,this.world.bringToTop(this.hero.sprite)},i.prototype.collectBoots=function(){if(this.bootsCollected=!0,this.boots.animations.play("introCollected"),this.game.conf.ISMUSICENABLED){var e=this.game.sound.add("heroTakeOff",.6,!1);e.play()}var i={x:this.hero.sprite.x,y:this.hero.sprite.y};this.hero.sprite.x=-100,this.hero.sprite.y=-150,this.hero.sprite.body.enable=!1,this.setActors(),this.hero.sprite.x=i.x,this.hero.sprite.y=i.y,this.hero._state=new t.StateIntroFly(this.game,this.hero),this.hero._state.enterState(),this.hero.sprite.body.collideWorldBounds=!1,this.game.physics.arcade.enable(this.paralax5),this.game.time.events.add(2650,this.stopGroundParalax,this),this.game.time.events.add(9*Phaser.Timer.SECOND,this.finishLevel,this)},i.prototype.stopGroundParalax=function(){this.paralax5.stopScroll(),this.paralax5.body.velocity.x=-200},i.prototype.finishLevel=function(){this.game.sound.stopAll(),this.game.conf.FIRSTTIMEPLAYING=!1,localStorage.setItem("superhero.conf",JSON.stringify(this.game.conf)),this.game.state.start("Level1",!0,!1)},i.prototype.startMusic=function(){this.game.conf.ISMUSICENABLED&&(this.theme&&this.theme.destroy(),this.theme=this.game.add.audio("introTheme",.5,!0),this.theme.play())},i.prototype.checkPCInput=function(){if(this.playerCanInteract&&(this.pcFireButton.isDown&&this.hero.fire(),this.pcNukeButton.isDown&&this.hero.fireNuke(),this.pcWarpButton.isDown&&this.hero.fireWarp(),this.pcBombButton.isDown&&this.hero.fireRocket(),this.cursors.up.isDown&&this.hero.sprite.body.touching.down)){var t={x:0,y:0};this.cursors.up.isDown&&(t.y=-800),this.hero.move(t)}},i.prototype.checkForCollisions=function(){var t=this;this.hero.collideWithObject(this.paralax5);var e=this.enemyManager.enemies;e.forEach(function(e){return t.hero.diesWithGroup(e.bullets)}),this.obstacleManager.collidesWith(this.hero.sprite),this.obstacleManager.diesWith(this.hero.bullets,this.killWall,this),this.obstacleManager.diesWith(this.hero.rockets,this.killWall,this),e.forEach(function(e){e.collideWithObject(e.shadow),e.diesWithGroup(t.hero.bullets),e.diesWithGroup(t.hero.rockets),t.obstacleManager.diesWith(e.bullets,t.killWall,t)}),this.collectableManager.checkCollectedBy(this.hero),this.boots&&!this.bootsCollected&&this.game.physics.arcade.overlap(this.hero.sprite,this.boots,this.collectBoots,null,this)},i.prototype.killWall=function(t,e){"bullet1"==t.frameName&&(t.kill(),e.frameName.indexOf("grey")>-1)||(e.kill(),this.collectableManager.spawnCollectable(e.position.x,e.position.y),this.obstacleManager.particleBurst(e))},i.prototype.shutdown=function(){this.game.world.removeAll()},i}(Phaser.State);t.Intro=e}(Superhero||(Superhero={}));var Superhero;!function(t){var e=function(e){function i(){this.conf=new t.Config,e.call(this,this.conf.WORLD.width,this.conf.WORLD.height,Phaser.CANVAS,"sh",null),this.state.add("Boot",t.Boot,!1),this.state.add("Preloader",t.Preloader,!1),this.state.add("Menu",t.Menu,!1),this.state.add("Level1",t.Level1,!1),this.state.add("Intro",t.Intro,!1),this.state.start("Boot")}return __extends(i,e),i}(Phaser.Game);t.Game=e}(Superhero||(Superhero={}));var sh;window.onload=function(){sh=new Superhero.Game};